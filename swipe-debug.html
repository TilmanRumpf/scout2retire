<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swipe Debug</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        .container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .debug-area {
            background: white;
            padding: 40px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 300px;
        }
        .log {
            background: #000;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            background: #007bff;
            color: white;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Swipe Gesture Debug Test</h1>
        
        <div class="status" id="status">
            Touch the debug area below and swipe left/right
        </div>
        
        <div class="debug-area" id="debugArea">
            <h2>Swipe Test Area</h2>
            <p>Swipe left or right on this area to test touch events</p>
            <p>Current step: <span id="currentStep">1</span> of 5</p>
        </div>
        
        <div class="log" id="log">
            <div>Debug log will appear here...</div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const maxSteps = 5;
        let touchStartX = null;
        let touchEndX = null;
        
        const logElement = document.getElementById('log');
        const statusElement = document.getElementById('status');
        const currentStepElement = document.getElementById('currentStep');
        const debugArea = document.getElementById('debugArea');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function updateStatus(message) {
            statusElement.textContent = message;
        }
        
        function updateStep() {
            currentStepElement.textContent = currentStep;
        }
        
        function handleSwipeLeft() {
            if (currentStep < maxSteps) {
                currentStep++;
                updateStep();
                updateStatus(`Swiped Left - Advanced to step ${currentStep}`);
                log(`SWIPE LEFT: Step ${currentStep-1} → ${currentStep}`);
            } else {
                log('SWIPE LEFT: Already at last step');
            }
        }
        
        function handleSwipeRight() {
            if (currentStep > 1) {
                currentStep--;
                updateStep();
                updateStatus(`Swiped Right - Back to step ${currentStep}`);
                log(`SWIPE RIGHT: Step ${currentStep+1} → ${currentStep}`);
            } else {
                log('SWIPE RIGHT: Already at first step');
            }
        }
        
        // Touch event handlers - exactly like the useSwipeGesture hook
        const handleTouchStart = (e) => {
            touchStartX = e.touches[0].clientX;
            touchEndX = null;
            log(`TOUCH START: X=${touchStartX}`);
            updateStatus('Touch started...');
        };
        
        const handleTouchMove = (e) => {
            touchEndX = e.touches[0].clientX;
            const distance = touchStartX - touchEndX;
            log(`TOUCH MOVE: X=${touchEndX}, Distance=${distance}`);
        };
        
        const handleTouchEnd = () => {
            if (!touchStartX || !touchEndX) {
                log('TOUCH END: Missing start or end coordinates');
                updateStatus('Touch ended without proper coordinates');
                return;
            }
            
            const minSwipeDistance = 50;
            const distance = touchStartX - touchEndX;
            const isLeftSwipe = distance > minSwipeDistance;
            const isRightSwipe = distance < -minSwipeDistance;
            
            log(`TOUCH END: Distance=${distance}, MinSwipe=${minSwipeDistance}`);
            log(`ANALYSIS: LeftSwipe=${isLeftSwipe}, RightSwipe=${isRightSwipe}`);
            
            if (isLeftSwipe) {
                handleSwipeLeft();
            } else if (isRightSwipe) {
                handleSwipeRight();
            } else {
                log('TOUCH END: No swipe detected (distance too small)');
                updateStatus('Touch ended - no swipe detected');
            }
        };
        
        // Add event listeners to debug area
        debugArea.addEventListener('touchstart', handleTouchStart);
        debugArea.addEventListener('touchmove', handleTouchMove);
        debugArea.addEventListener('touchend', handleTouchEnd);
        
        // Also add mouse events for desktop testing
        let mouseStartX = null;
        let mouseEndX = null;
        let mouseDown = false;
        
        debugArea.addEventListener('mousedown', (e) => {
            mouseDown = true;
            mouseStartX = e.clientX;
            mouseEndX = null;
            log(`MOUSE DOWN: X=${mouseStartX}`);
        });
        
        debugArea.addEventListener('mousemove', (e) => {
            if (mouseDown) {
                mouseEndX = e.clientX;
            }
        });
        
        debugArea.addEventListener('mouseup', () => {
            if (!mouseDown) return;
            mouseDown = false;
            
            if (!mouseStartX || !mouseEndX) {
                log('MOUSE UP: Missing start or end coordinates');
                return;
            }
            
            const minSwipeDistance = 50;
            const distance = mouseStartX - mouseEndX;
            const isLeftSwipe = distance > minSwipeDistance;
            const isRightSwipe = distance < -minSwipeDistance;
            
            log(`MOUSE UP: Distance=${distance}, LeftSwipe=${isLeftSwipe}, RightSwipe=${isRightSwipe}`);
            
            if (isLeftSwipe) {
                handleSwipeLeft();
            } else if (isRightSwipe) {
                handleSwipeRight();
            }
        });
        
        log('Swipe debug test initialized');
        log('Swipe left to advance, swipe right to go back');
        updateStatus('Ready for testing - swipe left/right on the debug area');
    </script>
</body>
</html>