-- =====================================================
-- SCOUT2RETIRE COMPLETE TOWN DATA POPULATION
-- Final comprehensive script to populate all 23 towns
-- with complete data for all 55+ columns
-- =====================================================
-- INSTRUCTIONS FOR EXECUTION:
-- 1. Open Supabase Dashboard
-- 2. Go to SQL Editor
-- 3. Paste this entire script
-- 4. Click "Run" 
-- 5. Verify results with the verification queries at the end
-- =====================================================

-- Start transaction for safety
BEGIN;

-- Create temporary function to safely update towns
CREATE OR REPLACE FUNCTION update_town_data(
    p_name TEXT,
    p_data JSONB
) RETURNS VOID AS $$
BEGIN
    UPDATE towns 
    SET 
        country = COALESCE(p_data->>'country', country),
        region = COALESCE(p_data->>'region', region),
        latitude = COALESCE((p_data->>'latitude')::NUMERIC, latitude),
        longitude = COALESCE((p_data->>'longitude')::NUMERIC, longitude),
        population = COALESCE((p_data->>'population')::INTEGER, population),
        weather_summer_high = COALESCE((p_data->>'weather_summer_high')::INTEGER, weather_summer_high),
        weather_summer_low = COALESCE((p_data->>'weather_summer_low')::INTEGER, weather_summer_low),
        weather_winter_high = COALESCE((p_data->>'weather_winter_high')::INTEGER, weather_winter_high),
        weather_winter_low = COALESCE((p_data->>'weather_winter_low')::INTEGER, weather_winter_low),
        cost_of_living_index = COALESCE((p_data->>'cost_of_living_index')::INTEGER, cost_of_living_index),
        rent_1br_city_center_eur = COALESCE((p_data->>'rent_1br_city_center_eur')::INTEGER, rent_1br_city_center_eur),
        rent_1br_outside_center_eur = COALESCE((p_data->>'rent_1br_outside_center_eur')::INTEGER, rent_1br_outside_center_eur),
        meal_inexpensive_restaurant_eur = COALESCE((p_data->>'meal_inexpensive_restaurant_eur')::NUMERIC(10,2), meal_inexpensive_restaurant_eur),
        groceries_index = COALESCE((p_data->>'groceries_index')::INTEGER, groceries_index),
        public_transport_monthly_eur = COALESCE((p_data->>'public_transport_monthly_eur')::INTEGER, public_transport_monthly_eur),
        language = COALESCE(p_data->>'language', language),
        english_proficiency = COALESCE(p_data->>'english_proficiency', english_proficiency),
        healthcare_quality_index = COALESCE((p_data->>'healthcare_quality_index')::INTEGER, healthcare_quality_index),
        healthcare_description = COALESCE(p_data->>'healthcare_description', healthcare_description),
        safety_index = COALESCE((p_data->>'safety_index')::INTEGER, safety_index),
        crime_description = COALESCE(p_data->>'crime_description', crime_description),
        visa_requirements = COALESCE(p_data->>'visa_requirements', visa_requirements),
        residency_info = COALESCE(p_data->>'residency_info', residency_info),
        tax_info = COALESCE(p_data->>'tax_info', tax_info),
        description = COALESCE(p_data->>'description', description),
        lifestyle_description = COALESCE(p_data->>'lifestyle_description', lifestyle_description),
        cultural_attractions = COALESCE((p_data->'cultural_attractions')::TEXT[], cultural_attractions),
        outdoor_activities = COALESCE((p_data->'outdoor_activities')::TEXT[], outdoor_activities),
        senior_communities = COALESCE((p_data->'senior_communities')::TEXT[], senior_communities),
        volunteer_opportunities = COALESCE((p_data->'volunteer_opportunities')::TEXT[], volunteer_opportunities),
        nearby_airports = COALESCE((p_data->'nearby_airports')::TEXT[], nearby_airports),
        public_transport_quality = COALESCE(p_data->>'public_transport_quality', public_transport_quality),
        walkability_score = COALESCE((p_data->>'walkability_score')::INTEGER, walkability_score),
        bike_infrastructure = COALESCE(p_data->>'bike_infrastructure', bike_infrastructure),
        internet_speed_mbps = COALESCE((p_data->>'internet_speed_mbps')::INTEGER, internet_speed_mbps),
        utilities_monthly_eur = COALESCE((p_data->>'utilities_monthly_eur')::INTEGER, utilities_monthly_eur),
        beaches_nearby = COALESCE((p_data->>'beaches_nearby')::BOOLEAN, beaches_nearby),
        mountains_nearby = COALESCE((p_data->>'mountains_nearby')::BOOLEAN, mountains_nearby),
        climate_zone = COALESCE(p_data->>'climate_zone', climate_zone),
        annual_rainfall_mm = COALESCE((p_data->>'annual_rainfall_mm')::INTEGER, annual_rainfall_mm),
        sunshine_hours_year = COALESCE((p_data->>'sunshine_hours_year')::INTEGER, sunshine_hours_year),
        expat_population = COALESCE(p_data->>'expat_population', expat_population),
        restaurant_variety = COALESCE(p_data->>'restaurant_variety', restaurant_variety),
        golf_courses_nearby = COALESCE((p_data->>'golf_courses_nearby')::INTEGER, golf_courses_nearby),
        special_considerations = COALESCE(p_data->>'special_considerations', special_considerations),
        best_time_to_visit = COALESCE(p_data->>'best_time_to_visit', best_time_to_visit),
        image_url = COALESCE(p_data->>'image_url', image_url),
        timezone = COALESCE(p_data->>'timezone', timezone),
        currency = COALESCE(p_data->>'currency', currency),
        political_stability = COALESCE(p_data->>'political_stability', political_stability),
        lgbtq_friendliness = COALESCE(p_data->>'lgbtq_friendliness', lgbtq_friendliness),
        disability_access = COALESCE(p_data->>'disability_access', disability_access),
        pet_friendliness = COALESCE(p_data->>'pet_friendliness', pet_friendliness),
        retirement_visa_available = COALESCE((p_data->>'retirement_visa_available')::BOOLEAN, retirement_visa_available),
        updated_at = NOW()
    WHERE name = p_name;
END;
$$ LANGUAGE plpgsql;

-- =====================================================
-- POPULATE DATA FOR ALL 23 TOWNS
-- =====================================================

-- 1. ALGARVE, PORTUGAL
SELECT update_town_data('Algarve, Portugal', '{
    "country": "Portugal",
    "region": "Southern Portugal",
    "latitude": 37.0894,
    "longitude": -8.2477,
    "population": 467000,
    "weather_summer_high": 29,
    "weather_summer_low": 20,
    "weather_winter_high": 16,
    "weather_winter_low": 8,
    "cost_of_living_index": 55,
    "rent_1br_city_center_eur": 850,
    "rent_1br_outside_center_eur": 650,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 48,
    "public_transport_monthly_eur": 40,
    "language": "Portuguese",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 81,
    "healthcare_description": "Portugal has excellent public healthcare (SNS). EU citizens get free/reduced care with EHIC. Private health insurance available for 50-100€/month. Many English-speaking doctors in Algarve.",
    "safety_index": 84,
    "crime_description": "Very safe region with low crime rates. Petty theft in tourist areas during summer. Police presence is good. Safe for walking at night in most areas.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need D7 visa (passive income ~€760/month) or Golden Visa. 90-day visa-free for tourism.",
    "residency_info": "D7 visa leads to temporary residence (1 year, then 2-year renewals). Permanent residence after 5 years. NHR tax regime available for 10 years.",
    "tax_info": "NHR regime: 10% tax on pensions, 20% on other income for 10 years. No wealth tax. Property tax 0.3-0.8%. No inheritance tax for spouses/children.",
    "description": "The Algarve is Portugal''s southernmost region, famous for its stunning coastline, year-round sunshine, and relaxed lifestyle perfect for retirees.",
    "lifestyle_description": "Laid-back Mediterranean lifestyle with focus on outdoor living, fresh seafood, and family values. Large expat community, especially British and German retirees. Golf capital of Portugal.",
    "cultural_attractions": ["Historic towns like Lagos and Tavira", "Moorish castles and churches", "Traditional markets and festivals", "Fado music venues", "Art galleries in Loulé and Faro"],
    "outdoor_activities": ["300km of beaches", "45+ golf courses", "Hiking in Via Algarviana", "Birdwatching in Ria Formosa", "Water sports and sailing", "Cycling along coastal paths"],
    "senior_communities": ["Vale de Parra retirement village", "Vilamoura expat community", "International Women''s Club Algarve", "Algarve Senior Bikers", "University of Third Age groups"],
    "volunteer_opportunities": ["Animal shelters (APAA)", "Environmental groups (A Rocha)", "Food banks in Faro", "English teaching programs", "Beach cleanup initiatives"],
    "nearby_airports": ["Faro Airport (FAO) - main hub", "Seville Airport (2.5 hours)", "Lisbon Airport (2.5 hours)"],
    "public_transport_quality": "Limited but improving. Trains connect main coastal towns. Buses serve most areas. Car recommended for full mobility.",
    "walkability_score": 72,
    "bike_infrastructure": "Ecovia coastal cycle path (214km). Many towns adding bike lanes. Bike-friendly culture developing.",
    "internet_speed_mbps": 100,
    "utilities_monthly_eur": 120,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 500,
    "sunshine_hours_year": 3000,
    "expat_population": "Large (100,000+)",
    "restaurant_variety": "Excellent - Portuguese, international, vegetarian options increasing",
    "golf_courses_nearby": 45,
    "special_considerations": "Can be crowded in summer. Some areas very quiet in winter. Learn basic Portuguese for better integration.",
    "best_time_to_visit": "April-June, September-November",
    "image_url": "https://example.com/algarve.jpg",
    "timezone": "Western European Time (WET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable EU democracy",
    "lgbtq_friendliness": "Generally accepting, especially in tourist areas",
    "disability_access": "Improving, newer buildings accessible",
    "pet_friendliness": "Very pet-friendly, dogs allowed in many places",
    "retirement_visa_available": true
}'::jsonb);

-- 2. ANDALUSIA, SPAIN
SELECT update_town_data('Andalusia, Spain', '{
    "country": "Spain",
    "region": "Southern Spain",
    "latitude": 37.5443,
    "longitude": -4.7278,
    "population": 8400000,
    "weather_summer_high": 36,
    "weather_summer_low": 22,
    "weather_winter_high": 17,
    "weather_winter_low": 6,
    "cost_of_living_index": 58,
    "rent_1br_city_center_eur": 700,
    "rent_1br_outside_center_eur": 500,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 50,
    "public_transport_monthly_eur": 35,
    "language": "Spanish",
    "english_proficiency": "Low to Moderate",
    "healthcare_quality_index": 85,
    "healthcare_description": "Spain has one of the best healthcare systems globally. Public healthcare free for residents. Private insurance 50-150€/month. Many specialists, short wait times.",
    "safety_index": 80,
    "crime_description": "Generally very safe. Petty theft in tourist areas of cities. Rural areas extremely safe. Strong family culture contributes to safety.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need non-lucrative visa (€2,400/month income) or Golden Visa. 90-day visa-free for tourism.",
    "residency_info": "Initial residence permit for 1 year, renewable for 2 years twice, then permanent residence. Can apply for citizenship after 10 years.",
    "tax_info": "Progressive tax 19-47%. Wealth tax varies by region. Beckham Law available for some. Property tax 0.4-1.1%. Double taxation treaties with many countries.",
    "description": "Andalusia offers authentic Spanish culture, stunning architecture, beautiful beaches, and mountain villages, with a passionate, warm lifestyle.",
    "lifestyle_description": "Traditional Spanish lifestyle with siestas, late dinners, and strong family bonds. Vibrant festivals, flamenco culture, and tapas tradition. More authentic and less touristy than coastal resorts.",
    "cultural_attractions": ["Alhambra Palace in Granada", "Mezquita in Córdoba", "Seville Cathedral and Alcázar", "White villages (Pueblos Blancos)", "Flamenco shows and museums", "Picasso Museum in Málaga"],
    "outdoor_activities": ["Beaches of Costa del Sol", "Sierra Nevada skiing", "Caminito del Rey hiking", "Doñana National Park", "Cycling in olive groves", "Horse riding in Jerez"],
    "senior_communities": ["International communities in Marbella", "Expat groups in Málaga", "Senior centers (Centros de Mayores)", "University programs for seniors", "Walking groups in major cities"],
    "volunteer_opportunities": ["Red Cross (Cruz Roja)", "Animal shelters", "Cudeca hospice", "Environmental groups", "Teaching English", "Cultural exchange programs"],
    "nearby_airports": ["Málaga Airport (AGP)", "Seville Airport (SVQ)", "Granada Airport (GRX)", "Jerez Airport (XRY)", "Gibraltar Airport nearby"],
    "public_transport_quality": "Excellent in cities. High-speed trains connect major cities. Comprehensive bus network. Metro in Málaga, Seville, Granada.",
    "walkability_score": 78,
    "bike_infrastructure": "Improving rapidly. Seville is bike capital of Spain. Coastal bike paths. City bike-sharing systems.",
    "internet_speed_mbps": 150,
    "utilities_monthly_eur": 100,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean/Continental",
    "annual_rainfall_mm": 600,
    "sunshine_hours_year": 2800,
    "expat_population": "Large (500,000+)",
    "restaurant_variety": "Excellent - Traditional Spanish, tapas culture, growing international options",
    "golf_courses_nearby": 100,
    "special_considerations": "Very hot summers inland. Spanish language important for integration. Bureaucracy can be slow.",
    "best_time_to_visit": "March-May, September-November",
    "image_url": "https://example.com/andalusia.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU democracy",
    "lgbtq_friendliness": "Generally accepting, especially in cities",
    "disability_access": "Good in cities, variable in rural areas",
    "pet_friendliness": "Pet-friendly culture, dogs common",
    "retirement_visa_available": true
}'::jsonb);

-- 3. PUGLIA, ITALY
SELECT update_town_data('Puglia, Italy', '{
    "country": "Italy",
    "region": "Southern Italy",
    "latitude": 41.0082,
    "longitude": 16.7426,
    "population": 4000000,
    "weather_summer_high": 30,
    "weather_summer_low": 22,
    "weather_winter_high": 13,
    "weather_winter_low": 5,
    "cost_of_living_index": 60,
    "rent_1br_city_center_eur": 500,
    "rent_1br_outside_center_eur": 350,
    "meal_inexpensive_restaurant_eur": 15.00,
    "groceries_index": 55,
    "public_transport_monthly_eur": 35,
    "language": "Italian",
    "english_proficiency": "Low to Moderate",
    "healthcare_quality_index": 80,
    "healthcare_description": "Italy''s SSN provides universal healthcare. EU citizens covered with EHIC. Quality varies but generally good. Private options available. Some English-speaking doctors in tourist areas.",
    "safety_index": 75,
    "crime_description": "Generally safe, especially in rural areas and small towns. Some petty crime in larger cities. Strong community bonds enhance safety. Avoid isolated areas at night.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need elective residency visa (€31,000/year income). 90-day visa-free for tourism. Investment visa available.",
    "residency_info": "Permesso di soggiorno for 1-2 years, renewable. Permanent residence after 5 years. Citizenship possible after 10 years residency.",
    "tax_info": "Progressive tax 23-43%. 7% flat tax option for foreign pensioners in small towns. Property tax (IMU) varies. No wealth tax for residents.",
    "description": "Puglia, the heel of Italy''s boot, offers authentic Italian living with whitewashed villages, ancient olive groves, crystal-clear seas, and incredible cuisine.",
    "lifestyle_description": "Slow-paced, authentic Italian lifestyle. Strong food culture with local specialties. Family-oriented society. Less touristy than other Italian regions. Growing expat community.",
    "cultural_attractions": ["Trulli houses of Alberobello", "Baroque Lecce", "Castel del Monte", "Ancient Matera nearby", "Traditional festivals", "Local craft traditions"],
    "outdoor_activities": ["800km of coastline", "Gargano National Park", "Cycling through olive groves", "Sailing and water sports", "Walking in historic centers", "Beach activities"],
    "senior_communities": ["Growing expat communities", "Italian social centers", "International groups in Lecce", "Retirement communities developing", "Language exchange groups"],
    "volunteer_opportunities": ["Archaeological projects", "Environmental protection", "Teaching programs", "Church organizations", "Cultural preservation", "Local festivals"],
    "nearby_airports": ["Bari Airport (BRI)", "Brindisi Airport (BDS)", "Naples Airport (2.5 hours)"],
    "public_transport_quality": "Basic but functional. Trains connect major cities. Local buses serve most areas. Car useful for exploring.",
    "walkability_score": 70,
    "bike_infrastructure": "Limited but improving. Coastal cycle routes developing. Rural roads good for cycling.",
    "internet_speed_mbps": 80,
    "utilities_monthly_eur": 120,
    "beaches_nearby": true,
    "mountains_nearby": false,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 650,
    "sunshine_hours_year": 2600,
    "expat_population": "Growing (50,000+)",
    "restaurant_variety": "Excellent local cuisine, limited international options outside cities",
    "golf_courses_nearby": 8,
    "special_considerations": "Italian language essential for daily life. Slower pace may frustrate some. August very hot and crowded.",
    "best_time_to_visit": "April-June, September-October",
    "image_url": "https://example.com/puglia.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU democracy",
    "lgbtq_friendliness": "Increasingly accepting, especially in cities",
    "disability_access": "Challenging in historic areas",
    "pet_friendliness": "Very pet-friendly culture",
    "retirement_visa_available": true
}'::jsonb);

-- 4. MALTA
SELECT update_town_data('Malta', '{
    "country": "Malta",
    "region": "Mediterranean Island",
    "latitude": 35.8997,
    "longitude": 14.5146,
    "population": 515000,
    "weather_summer_high": 32,
    "weather_summer_low": 23,
    "weather_winter_high": 16,
    "weather_winter_low": 10,
    "cost_of_living_index": 70,
    "rent_1br_city_center_eur": 900,
    "rent_1br_outside_center_eur": 700,
    "meal_inexpensive_restaurant_eur": 15.00,
    "groceries_index": 65,
    "public_transport_monthly_eur": 26,
    "language": "Maltese, English",
    "english_proficiency": "Very High (Official Language)",
    "healthcare_quality_index": 78,
    "healthcare_description": "Good public healthcare system free for residents. EU citizens covered with EHIC. Private healthcare widely available. Many English-speaking medical professionals.",
    "safety_index": 82,
    "crime_description": "One of Europe''s safest countries. Very low violent crime. Some petty theft in tourist areas. Generally safe to walk at night. Strong community policing.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU can apply for Global Residence Programme or Retirement Programme. 90-day visa-free for many countries.",
    "residency_info": "Various residency programs available. Permanent residence after 5 years. Special tax programs for foreign residents. Citizenship by investment available.",
    "tax_info": "15% flat tax for foreign pensioners. Progressive rates 0-35% for others. No wealth tax. Property tax minimal. Favorable double taxation treaties.",
    "description": "Malta is a sunny English-speaking island nation offering a unique blend of Mediterranean lifestyle, British influences, and ancient history.",
    "lifestyle_description": "Relaxed Mediterranean pace with British organization. Very social culture with festas and community events. Easy integration for English speakers. Compact size means everything is nearby.",
    "cultural_attractions": ["Valletta UNESCO World Heritage", "Ancient temples (older than pyramids)", "Medieval Mdina", "Grand Master''s Palace", "Traditional festas", "Baroque churches"],
    "outdoor_activities": ["Swimming and diving", "Coastal walks", "Sailing and boating", "Historical site visits", "Beach activities", "Golf at Royal Malta"],
    "senior_communities": ["Large British expat community", "International Residents Association", "Various social clubs", "University of Third Age", "Bridge and social groups"],
    "volunteer_opportunities": ["Heritage Malta projects", "Environmental groups", "Animal welfare organizations", "Community centers", "Teaching and mentoring", "Church activities"],
    "nearby_airports": ["Malta International Airport (MLA)", "Sicily airports (ferry connection)"],
    "public_transport_quality": "Comprehensive bus network covering entire island. Affordable and frequent. No rail system. Ferries to Gozo.",
    "walkability_score": 68,
    "bike_infrastructure": "Limited, roads can be busy. Some coastal paths suitable for cycling.",
    "internet_speed_mbps": 100,
    "utilities_monthly_eur": 150,
    "beaches_nearby": true,
    "mountains_nearby": false,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 550,
    "sunshine_hours_year": 3000,
    "expat_population": "Very Large (20% of population)",
    "restaurant_variety": "Good mix of Maltese and international cuisine",
    "golf_courses_nearby": 1,
    "special_considerations": "Small island can feel limiting. Summer very hot and humid. Can be crowded. Limited green spaces.",
    "best_time_to_visit": "April-June, September-November",
    "image_url": "https://example.com/malta.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable EU democracy",
    "lgbtq_friendliness": "Progressive, same-sex marriage legal",
    "disability_access": "Improving but challenging in historic areas",
    "pet_friendliness": "Pet-friendly with some restrictions",
    "retirement_visa_available": true
}'::jsonb);

-- 5. CRETE, GREECE
SELECT update_town_data('Crete, Greece', '{
    "country": "Greece",
    "region": "Greek Islands",
    "latitude": 35.2401,
    "longitude": 24.8093,
    "population": 635000,
    "weather_summer_high": 30,
    "weather_summer_low": 22,
    "weather_winter_high": 15,
    "weather_winter_low": 9,
    "cost_of_living_index": 55,
    "rent_1br_city_center_eur": 450,
    "rent_1br_outside_center_eur": 350,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 52,
    "public_transport_monthly_eur": 30,
    "language": "Greek",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 73,
    "healthcare_description": "Public healthcare system (ESY) provides free care for residents. Quality varies, better in cities. Private clinics available. EU citizens covered with EHIC.",
    "safety_index": 85,
    "crime_description": "Very safe island with low crime rates. Friendly locals enhance security. Tourist areas see occasional petty theft. Rural areas extremely safe.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need residence permit (€2,000/month income). Golden Visa program available. 90-day visa-free for tourism.",
    "residency_info": "Initial permit for 2 years, renewable. Permanent residence after 5 years. Attractive tax regime for foreign pensioners in development.",
    "tax_info": "Progressive tax 9-44%. Foreign pension tax 7% flat rate available. Property tax (ENFIA) relatively low. No wealth tax.",
    "description": "Crete, Greece''s largest island, offers year-round sunshine, ancient history, mountain villages, pristine beaches, and legendary hospitality.",
    "lifestyle_description": "Relaxed Mediterranean lifestyle with strong traditions. Healthy diet and active outdoor living. Strong sense of community. Slower pace of life, especially in villages.",
    "cultural_attractions": ["Palace of Knossos", "Archaeological Museum", "Venetian harbors", "Byzantine churches", "Traditional villages", "Local festivals"],
    "outdoor_activities": ["Stunning beaches", "Samaria Gorge hiking", "Mountain trails", "Water sports", "Sailing and diving", "Cycling routes"],
    "senior_communities": ["Growing expat community", "International groups in Chania", "Heraklion social clubs", "Language exchange groups", "Walking and hiking clubs"],
    "volunteer_opportunities": ["Archaeological digs", "Environmental protection", "Animal welfare", "Teaching English", "Cultural preservation", "Community projects"],
    "nearby_airports": ["Heraklion Airport (HER)", "Chania Airport (CHQ)", "Athens connections"],
    "public_transport_quality": "Basic bus system connects major towns. Limited schedules. Car recommended for flexibility. Taxis available.",
    "walkability_score": 65,
    "bike_infrastructure": "Limited but scenic routes available. Mountain biking popular.",
    "internet_speed_mbps": 50,
    "utilities_monthly_eur": 100,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 500,
    "sunshine_hours_year": 2700,
    "expat_population": "Moderate (30,000+)",
    "restaurant_variety": "Excellent Greek cuisine, growing international options",
    "golf_courses_nearby": 2,
    "special_considerations": "Greek language helpful for integration. Island life has limitations. Tourist crowds in summer. Some areas very quiet in winter.",
    "best_time_to_visit": "April-June, September-November",
    "image_url": "https://example.com/crete.jpg",
    "timezone": "Eastern European Time (EET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU democracy",
    "lgbtq_friendliness": "Increasingly accepting, especially in cities",
    "disability_access": "Challenging outside main towns",
    "pet_friendliness": "Very pet-friendly culture",
    "retirement_visa_available": true
}'::jsonb);

-- 6. CYPRUS
SELECT update_town_data('Cyprus', '{
    "country": "Cyprus",
    "region": "Eastern Mediterranean",
    "latitude": 35.1264,
    "longitude": 33.4299,
    "population": 1200000,
    "weather_summer_high": 33,
    "weather_summer_low": 23,
    "weather_winter_high": 17,
    "weather_winter_low": 8,
    "cost_of_living_index": 65,
    "rent_1br_city_center_eur": 750,
    "rent_1br_outside_center_eur": 550,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 60,
    "public_transport_monthly_eur": 40,
    "language": "Greek, Turkish, English",
    "english_proficiency": "Very High",
    "healthcare_quality_index": 76,
    "healthcare_description": "Good healthcare system with public and private options. EU citizens get subsidized care. Many English-speaking doctors. Private insurance recommended for faster service.",
    "safety_index": 88,
    "crime_description": "One of Europe''s safest countries. Very low crime rates. Safe to walk at night. Strong community bonds. Avoid buffer zone between north and south.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU can get residence permit with €30,000 annual income. Fast-track residence available. 90-day visa-free for many.",
    "residency_info": "Category F permit for retirees. Permanent residence after 5 years. Tax residency after 183 days/year. Various investment programs available.",
    "tax_info": "Low taxes - 0% on pensions up to €3,420, then 5%. Corporate tax 12.5%. No inheritance tax. Favorable double taxation treaties.",
    "description": "Cyprus offers year-round sunshine, beautiful beaches, low taxes, English-speaking environment, and a relaxed Mediterranean lifestyle with British influences.",
    "lifestyle_description": "Relaxed pace with British colonial influences. Beach culture, outdoor dining, family-oriented society. Large expat community makes integration easier. Mix of traditional and modern.",
    "cultural_attractions": ["Ancient Kourion", "Paphos mosaics", "Troodos monasteries", "Traditional villages", "Wine routes", "Cultural festivals"],
    "outdoor_activities": ["Blue Flag beaches", "Troodos mountain hiking", "Water sports and diving", "Golf courses", "Cycling routes", "Nature trails"],
    "senior_communities": ["Large British expat community", "Paphos International Club", "Various social groups", "Golf clubs", "Bridge and social clubs"],
    "volunteer_opportunities": ["Animal shelters", "Environmental groups", "Community centers", "Teaching programs", "Archaeological projects", "Church activities"],
    "nearby_airports": ["Larnaca Airport (LCA)", "Paphos Airport (PFO)"],
    "public_transport_quality": "Limited bus service between cities. No railway. Car essential for convenience. Taxis widely available.",
    "walkability_score": 60,
    "bike_infrastructure": "Developing coastal paths. Mountain biking in Troodos.",
    "internet_speed_mbps": 75,
    "utilities_monthly_eur": 140,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 450,
    "sunshine_hours_year": 3200,
    "expat_population": "Very Large (100,000+)",
    "restaurant_variety": "Good mix of Cypriot, Greek, and international cuisine",
    "golf_courses_nearby": 10,
    "special_considerations": "Divided island (avoid politics). Can be very hot in summer. Tourist areas busy. Some areas quiet in winter.",
    "best_time_to_visit": "March-May, October-November",
    "image_url": "https://example.com/cyprus.jpg",
    "timezone": "Eastern European Time (EET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU member (Republic of Cyprus)",
    "lgbtq_friendliness": "Increasingly accepting",
    "disability_access": "Good in tourist areas",
    "pet_friendliness": "Pet-friendly with EU pet passport",
    "retirement_visa_available": true
}'::jsonb);

-- 7. MADEIRA, PORTUGAL
SELECT update_town_data('Madeira, Portugal', '{
    "country": "Portugal",
    "region": "Atlantic Island",
    "latitude": 32.6669,
    "longitude": -16.9241,
    "population": 260000,
    "weather_summer_high": 26,
    "weather_summer_low": 20,
    "weather_winter_high": 19,
    "weather_winter_low": 14,
    "cost_of_living_index": 50,
    "rent_1br_city_center_eur": 700,
    "rent_1br_outside_center_eur": 500,
    "meal_inexpensive_restaurant_eur": 8.00,
    "groceries_index": 45,
    "public_transport_monthly_eur": 30,
    "language": "Portuguese",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 80,
    "healthcare_description": "Good public healthcare through Portuguese SNS. New modern hospital in Funchal. EU citizens covered. Private options available. Some English-speaking doctors.",
    "safety_index": 86,
    "crime_description": "Very safe island with minimal crime. Friendly locals. Safe to walk everywhere. No dangerous animals or insects. Natural disasters rare.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need D7 visa or Golden Visa. Same as mainland Portugal. 90-day visa-free for tourism.",
    "residency_info": "Same as mainland Portugal. NHR tax regime available. Many retirees benefit from favorable tax treatment. Easy residency process.",
    "tax_info": "NHR regime: 10% on foreign pensions for 10 years. No wealth tax. Low property taxes. Special Madeira tax incentives available.",
    "description": "Madeira, the ''Island of Eternal Spring,'' offers year-round mild weather, dramatic landscapes, safety, and a peaceful retirement paradise.",
    "lifestyle_description": "Relaxed island pace with Portuguese charm. Strong community feel. Outdoor-focused lifestyle. Growing expat community. Excellent for active retirees who enjoy nature.",
    "cultural_attractions": ["Funchal old town", "Wine lodges", "Botanical gardens", "Traditional markets", "Religious festivals", "Museums and galleries"],
    "outdoor_activities": ["Levada walks (1,500km trails)", "Mountain hiking", "Swimming pools and beaches", "Whale watching", "Gardens and parks", "Golf courses"],
    "senior_communities": ["International Club Funchal", "British community groups", "Walking groups", "Bridge clubs", "Language exchange", "Volunteer networks"],
    "volunteer_opportunities": ["Environmental projects", "Animal welfare", "Community gardens", "Tourism support", "Teaching languages", "Cultural events"],
    "nearby_airports": ["Madeira Airport (FNC)", "Porto Santo Airport", "Lisbon connections"],
    "public_transport_quality": "Good bus network in Funchal. Limited elsewhere. Cable cars for tourism. Car useful for exploring.",
    "walkability_score": 73,
    "bike_infrastructure": "Limited due to terrain. Some coastal paths.",
    "internet_speed_mbps": 100,
    "utilities_monthly_eur": 80,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Subtropical",
    "annual_rainfall_mm": 600,
    "sunshine_hours_year": 2200,
    "expat_population": "Growing (20,000+)",
    "restaurant_variety": "Good Portuguese cuisine, growing international options",
    "golf_courses_nearby": 3,
    "special_considerations": "Island isolation for some. Steep terrain limits mobility. Can be humid. Flights may be weather-dependent.",
    "best_time_to_visit": "Year-round destination",
    "image_url": "https://example.com/madeira.jpg",
    "timezone": "Western European Time (WET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable (part of Portugal)",
    "lgbtq_friendliness": "Generally accepting",
    "disability_access": "Challenging due to terrain",
    "pet_friendliness": "Pet-friendly culture",
    "retirement_visa_available": true
}'::jsonb);

-- 8. CANARY ISLANDS, SPAIN
SELECT update_town_data('Canary Islands, Spain', '{
    "country": "Spain",
    "region": "Atlantic Islands",
    "latitude": 28.0997,
    "longitude": -15.4134,
    "population": 2200000,
    "weather_summer_high": 28,
    "weather_summer_low": 21,
    "weather_winter_high": 21,
    "weather_winter_low": 15,
    "cost_of_living_index": 55,
    "rent_1br_city_center_eur": 750,
    "rent_1br_outside_center_eur": 550,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 50,
    "public_transport_monthly_eur": 40,
    "language": "Spanish",
    "english_proficiency": "Moderate",
    "healthcare_quality_index": 83,
    "healthcare_description": "Excellent Spanish public healthcare. Modern hospitals on main islands. EU citizens fully covered. Private options available. Many German-speaking doctors.",
    "safety_index": 82,
    "crime_description": "Very safe islands. Low crime rates. Tourist areas have petty theft. Local communities very secure. Good police presence.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need Spanish residence visa. Same requirements as mainland Spain. 90-day visa-free for tourism.",
    "residency_info": "Spanish residency rules apply. Special Canary Islands tax benefits. ZEC (low tax zone) advantages. Popular with EU retirees.",
    "tax_info": "Lower taxes than mainland Spain. IGIC instead of VAT (7%). Special tax incentives. No wealth tax for residents. Favorable for businesses.",
    "description": "The Canary Islands offer year-round spring weather, diverse landscapes from beaches to volcanoes, and a relaxed Spanish island lifestyle.",
    "lifestyle_description": "Relaxed island lifestyle with Spanish flair. Each island has unique character. Large expat communities. Outdoor living year-round. Mix of tourism and local culture.",
    "cultural_attractions": ["Teide National Park", "Historic La Laguna", "César Manrique art", "Traditional villages", "Carnival celebrations", "Museums and galleries"],
    "outdoor_activities": ["Beaches and water sports", "Hiking and volcanoes", "Cycling routes", "Golf courses", "Sailing and diving", "Whale watching"],
    "senior_communities": ["Large German community", "British expat groups", "Scandinavian clubs", "International associations", "Sports and social clubs"],
    "volunteer_opportunities": ["Environmental protection", "Animal welfare", "Beach cleanups", "Community projects", "Teaching languages", "Tourism support"],
    "nearby_airports": ["Tenerife South (TFS)", "Gran Canaria (LPA)", "Lanzarote (ACE)", "Fuerteventura (FUE)", "La Palma (SPC)"],
    "public_transport_quality": "Good on main islands. Buses connect major areas. Trams in Tenerife. Inter-island ferries. Car useful.",
    "walkability_score": 70,
    "bike_infrastructure": "Developing. Good cycling roads. Mountain biking popular.",
    "internet_speed_mbps": 120,
    "utilities_monthly_eur": 90,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Subtropical",
    "annual_rainfall_mm": 250,
    "sunshine_hours_year": 2800,
    "expat_population": "Very Large (200,000+)",
    "restaurant_variety": "Spanish cuisine plus international options",
    "golf_courses_nearby": 25,
    "special_considerations": "Can be touristy. Island hopping requires planning. Wind can be strong. Each island very different.",
    "best_time_to_visit": "Year-round destination",
    "image_url": "https://example.com/canary-islands.jpg",
    "timezone": "Western European Time (WET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable (part of Spain)",
    "lgbtq_friendliness": "Very accepting, especially Gran Canaria",
    "disability_access": "Good in tourist areas",
    "pet_friendliness": "Pet-friendly with EU standards",
    "retirement_visa_available": true
}'::jsonb);

-- 9. AZORES, PORTUGAL
SELECT update_town_data('Azores, Portugal', '{
    "country": "Portugal",
    "region": "Atlantic Islands",
    "latitude": 37.7412,
    "longitude": -25.6756,
    "population": 245000,
    "weather_summer_high": 25,
    "weather_summer_low": 18,
    "weather_winter_high": 17,
    "weather_winter_low": 11,
    "cost_of_living_index": 45,
    "rent_1br_city_center_eur": 500,
    "rent_1br_outside_center_eur": 400,
    "meal_inexpensive_restaurant_eur": 8.00,
    "groceries_index": 42,
    "public_transport_monthly_eur": 25,
    "language": "Portuguese",
    "english_proficiency": "Low to Moderate",
    "healthcare_quality_index": 75,
    "healthcare_description": "Portuguese public healthcare available. Main hospital in Ponta Delgada. Basic facilities on smaller islands. Medical evacuation available if needed.",
    "safety_index": 90,
    "crime_description": "Extremely safe islands. Virtually no crime. Strong community bonds. Natural beauty preserved. Only natural risks from ocean/weather.",
    "visa_requirements": "Same as mainland Portugal. EU citizens free movement. Non-EU need D7 or Golden Visa. 90-day tourist visa-free.",
    "residency_info": "Portuguese residency rules apply. NHR tax benefits available. Growing interest from remote workers and retirees.",
    "tax_info": "Same favorable NHR regime as mainland. 10% on foreign pensions. Low property taxes. No wealth tax.",
    "description": "The Azores archipelago offers unspoiled nature, mild climate, incredible landscapes, and one of Europe''s most peaceful retirement destinations.",
    "lifestyle_description": "Very quiet, nature-focused lifestyle. Strong agricultural traditions. Small communities. Perfect for those seeking tranquility and natural beauty. Limited nightlife/shopping.",
    "cultural_attractions": ["UNESCO Angra do Heroísmo", "Whale watching heritage", "Volcanic landscapes", "Traditional festivals", "Local handicrafts", "Tea plantations"],
    "outdoor_activities": ["Hiking trails", "Whale and dolphin watching", "Hot springs", "Lakes and waterfalls", "Surfing and diving", "Birdwatching"],
    "senior_communities": ["Small but growing expat community", "Local social centers", "Nature groups", "Walking clubs", "Cultural associations"],
    "volunteer_opportunities": ["Environmental conservation", "Marine protection", "Community projects", "Agricultural programs", "Tourism support", "Cultural preservation"],
    "nearby_airports": ["Ponta Delgada (PDL)", "Lajes (TER)", "Horta (HOR)", "Inter-island flights"],
    "public_transport_quality": "Limited. Buses in main towns. Car essential. Inter-island flights and ferries.",
    "walkability_score": 55,
    "bike_infrastructure": "Limited but scenic routes available.",
    "internet_speed_mbps": 50,
    "utilities_monthly_eur": 70,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Oceanic",
    "annual_rainfall_mm": 1000,
    "sunshine_hours_year": 1800,
    "expat_population": "Small but growing (5,000+)",
    "restaurant_variety": "Traditional Portuguese, limited international",
    "golf_courses_nearby": 3,
    "special_considerations": "Very isolated. Limited services. Weather changeable. Not for those who need urban amenities. Nature lovers paradise.",
    "best_time_to_visit": "May-September",
    "image_url": "https://example.com/azores.jpg",
    "timezone": "Azores Time (1 hour behind mainland)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable (part of Portugal)",
    "lgbtq_friendliness": "Traditional but respectful",
    "disability_access": "Limited, terrain challenging",
    "pet_friendliness": "Pet-friendly rural culture",
    "retirement_visa_available": true
}'::jsonb);

-- 10. NICE, FRANCE
SELECT update_town_data('Nice, France', '{
    "country": "France",
    "region": "French Riviera",
    "latitude": 43.7102,
    "longitude": 7.2620,
    "population": 340000,
    "weather_summer_high": 27,
    "weather_summer_low": 20,
    "weather_winter_high": 13,
    "weather_winter_low": 5,
    "cost_of_living_index": 85,
    "rent_1br_city_center_eur": 1200,
    "rent_1br_outside_center_eur": 900,
    "meal_inexpensive_restaurant_eur": 15.00,
    "groceries_index": 75,
    "public_transport_monthly_eur": 45,
    "language": "French",
    "english_proficiency": "Moderate",
    "healthcare_quality_index": 85,
    "healthcare_description": "Excellent French healthcare system, ranked #1 globally. Universal coverage for residents. Many private options. Some English-speaking doctors.",
    "safety_index": 72,
    "crime_description": "Generally safe but some petty crime. Tourist areas need vigilance. Residential areas very safe. Good police presence. Avoid isolated areas at night.",
    "visa_requirements": "EU citizens can stay indefinitely. Non-EU need long-stay visa with sufficient income (€1,500+/month). Various visa types available.",
    "residency_info": "Carte de séjour for 1-4 years, renewable. Permanent residence after 5 years. Path to citizenship available. Must show integration efforts.",
    "tax_info": "Progressive tax up to 45%. Wealth tax on assets over €1.3M. Property taxes moderate. US-France tax treaty prevents double taxation.",
    "description": "Nice offers glamorous Riviera living with pebble beaches, Belle Époque architecture, world-class culture, and sophisticated Mediterranean lifestyle.",
    "lifestyle_description": "Sophisticated urban lifestyle with beach access. Cultural events year-round. Elegant café culture. Mix of French and international residents. More formal than other Mediterranean destinations.",
    "cultural_attractions": ["Promenade des Anglais", "Old Town (Vieux Nice)", "Museums (Chagall, Matisse)", "Opera and theaters", "Carnival of Nice", "Russian Cathedral"],
    "outdoor_activities": ["Beach activities", "Coastal walks", "Hiking in nearby Alps", "Sailing and yachting", "Markets and gardens", "Day trips to Monaco"],
    "senior_communities": ["International community", "Anglo-American groups", "Various cultural associations", "University programs", "Sports clubs"],
    "volunteer_opportunities": ["Cultural organizations", "Environmental groups", "Social services", "Language exchange", "Arts programs", "Refugee support"],
    "nearby_airports": ["Nice Côte d''Azur (NCE)", "Monaco Heliport", "Marseille (2 hours)"],
    "public_transport_quality": "Excellent. Trams, buses cover city. Train connections along coast. New tram lines expanding.",
    "walkability_score": 85,
    "bike_infrastructure": "Good and improving. Bike-sharing system. Coastal cycle paths.",
    "internet_speed_mbps": 200,
    "utilities_monthly_eur": 150,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 750,
    "sunshine_hours_year": 2700,
    "expat_population": "Large (60,000+)",
    "restaurant_variety": "Excellent - French haute cuisine to casual international",
    "golf_courses_nearby": 15,
    "special_considerations": "Expensive city. French language important. Can be crowded in summer. Some areas very touristy.",
    "best_time_to_visit": "April-June, September-October",
    "image_url": "https://example.com/nice.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU democracy",
    "lgbtq_friendliness": "Very accepting",
    "disability_access": "Good and improving",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": true
}'::jsonb);

-- 11. LISBON, PORTUGAL
SELECT update_town_data('Lisbon, Portugal', '{
    "country": "Portugal",
    "region": "Central Portugal",
    "latitude": 38.7223,
    "longitude": -9.1393,
    "population": 550000,
    "weather_summer_high": 28,
    "weather_summer_low": 18,
    "weather_winter_high": 15,
    "weather_winter_low": 8,
    "cost_of_living_index": 65,
    "rent_1br_city_center_eur": 1100,
    "rent_1br_outside_center_eur": 750,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 52,
    "public_transport_monthly_eur": 40,
    "language": "Portuguese",
    "english_proficiency": "High",
    "healthcare_quality_index": 82,
    "healthcare_description": "Excellent public and private healthcare. Many English-speaking doctors. EU citizens covered. Private insurance affordable. Modern facilities.",
    "safety_index": 78,
    "crime_description": "Generally safe city. Some pickpocketing in tourist areas. Most neighborhoods very safe. Good police presence. Safe public transport.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need D7 visa (€760/month income) or Golden Visa. Digital nomad visa available. 90-day visa-free.",
    "residency_info": "Straightforward residency process. NHR tax benefits. Permanent residence after 5 years. Path to citizenship with language requirement.",
    "tax_info": "NHR: 10% on foreign pensions, 20% other income for 10 years. No wealth tax. Reasonable property taxes. Crypto-friendly.",
    "description": "Lisbon combines old-world charm with modern amenities, offering hills, tiles, trams, great food, culture, and a thriving expat community.",
    "lifestyle_description": "Vibrant urban lifestyle with traditional charm. Excellent food scene. Active cultural life. Large expat community. Good work-life balance. Walkable neighborhoods.",
    "cultural_attractions": ["Historic neighborhoods", "Fado music venues", "Museums and galleries", "Belém monuments", "Street art", "Cultural events"],
    "outdoor_activities": ["Nearby beaches", "Riverside walks", "Parks and gardens", "Day trips to Sintra", "Surfing (30 min)", "Golf courses nearby"],
    "senior_communities": ["Large international community", "Expat meetups", "Cultural associations", "Language exchanges", "Sports clubs", "Volunteer groups"],
    "volunteer_opportunities": ["Social projects", "Environmental initiatives", "Animal shelters", "Food banks", "Teaching programs", "Cultural organizations"],
    "nearby_airports": ["Lisbon Airport (LIS)", "Cascais Airport", "Porto (3 hours)"],
    "public_transport_quality": "Excellent. Metro, trams, buses, trains. Expanding metro. Senior discounts available.",
    "walkability_score": 82,
    "bike_infrastructure": "Improving rapidly. Bike lanes expanding. Bike-sharing system.",
    "internet_speed_mbps": 150,
    "utilities_monthly_eur": 100,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 750,
    "sunshine_hours_year": 2800,
    "expat_population": "Very Large (100,000+)",
    "restaurant_variety": "Excellent - traditional to modern international",
    "golf_courses_nearby": 20,
    "special_considerations": "Hills can be challenging. Growing tourism. Some gentrification. Portuguese helpful but not essential.",
    "best_time_to_visit": "March-May, September-November",
    "image_url": "https://example.com/lisbon.jpg",
    "timezone": "Western European Time (WET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable EU democracy",
    "lgbtq_friendliness": "Very accepting and progressive",
    "disability_access": "Challenging due to hills and cobblestones",
    "pet_friendliness": "Very pet-friendly city",
    "retirement_visa_available": true
}'::jsonb);

-- 12. VALENCIA, SPAIN
SELECT update_town_data('Valencia, Spain', '{
    "country": "Spain",
    "region": "Eastern Spain",
    "latitude": 39.4699,
    "longitude": -0.3763,
    "population": 800000,
    "weather_summer_high": 32,
    "weather_summer_low": 22,
    "weather_winter_high": 17,
    "weather_winter_low": 7,
    "cost_of_living_index": 62,
    "rent_1br_city_center_eur": 800,
    "rent_1br_outside_center_eur": 600,
    "meal_inexpensive_restaurant_eur": 11.00,
    "groceries_index": 53,
    "public_transport_monthly_eur": 40,
    "language": "Spanish, Valencian",
    "english_proficiency": "Moderate",
    "healthcare_quality_index": 84,
    "healthcare_description": "Excellent Spanish public healthcare. Modern hospitals. Short wait times. EU citizens fully covered. Private options affordable.",
    "safety_index": 81,
    "crime_description": "Safe city with low violent crime. Some petty theft in tourist areas. Residential areas very safe. Good street lighting and police presence.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need residence visa (€2,400/month income). Golden Visa option. 90-day visa-free for tourism.",
    "residency_info": "Standard Spanish residency process. Beckham Law for some. Permanent residence after 5 years. Citizenship after 10 years.",
    "tax_info": "Progressive tax 19-47%. Wealth tax in Valencia region. Property taxes moderate. Some regional benefits for new residents.",
    "description": "Valencia offers perfect Mediterranean climate, beaches, modern architecture, paella, festivals, and more affordable living than Madrid or Barcelona.",
    "lifestyle_description": "Perfect blend of city and beach life. Vibrant food scene. Year-round festivals. Strong cycling culture. Family-friendly. Less touristy than Barcelona.",
    "cultural_attractions": ["City of Arts and Sciences", "Historic center", "Central Market", "Las Fallas festival", "Museums", "Silk Exchange"],
    "outdoor_activities": ["City beaches", "Turia Gardens (9km park)", "Cycling paths", "Albufera Nature Park", "Sailing", "Nearby mountains"],
    "senior_communities": ["Growing expat community", "International clubs", "Sports groups", "Language exchanges", "Cultural associations", "University programs"],
    "volunteer_opportunities": ["Red Cross", "Food banks", "Environmental projects", "Animal shelters", "Teaching programs", "Festival organization"],
    "nearby_airports": ["Valencia Airport (VLC)", "Alicante (1.5 hours)", "Madrid AVE connection"],
    "public_transport_quality": "Excellent. Metro, buses, trams. Bike-sharing system. Good connectivity. Senior discounts.",
    "walkability_score": 80,
    "bike_infrastructure": "Excellent. 150km of bike lanes. Flat terrain. Bike-friendly culture.",
    "internet_speed_mbps": 200,
    "utilities_monthly_eur": 110,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 450,
    "sunshine_hours_year": 2700,
    "expat_population": "Large (80,000+)",
    "restaurant_variety": "Excellent - Spanish cuisine plus growing international scene",
    "golf_courses_nearby": 15,
    "special_considerations": "Hot summers. Spanish helpful for integration. August very quiet. Valencian language present but not required.",
    "best_time_to_visit": "March-June, September-November",
    "image_url": "https://example.com/valencia.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU democracy",
    "lgbtq_friendliness": "Very accepting",
    "disability_access": "Good and improving",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": true
}'::jsonb);

-- 13. BARCELONA, SPAIN
SELECT update_town_data('Barcelona, Spain', '{
    "country": "Spain",
    "region": "Catalonia",
    "latitude": 41.3851,
    "longitude": 2.1734,
    "population": 1620000,
    "weather_summer_high": 28,
    "weather_summer_low": 21,
    "weather_winter_high": 14,
    "weather_winter_low": 6,
    "cost_of_living_index": 75,
    "rent_1br_city_center_eur": 1200,
    "rent_1br_outside_center_eur": 900,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 60,
    "public_transport_monthly_eur": 55,
    "language": "Spanish, Catalan",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 86,
    "healthcare_description": "World-class healthcare system. Many private options. EU citizens covered. International clinics available. English-speaking doctors common.",
    "safety_index": 74,
    "crime_description": "Generally safe but watch for pickpockets. Tourist areas need extra caution. Residential neighborhoods safe. Good police presence.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need visa with income proof. Digital nomad visa available. Golden Visa option. 90-day tourist visa.",
    "residency_info": "Spanish residency rules apply. Can get Catalan residency certificate. Tax benefits possible. Clear path to permanent residence.",
    "tax_info": "Progressive tax rates. Wealth tax in Catalonia. Urban property taxes. Some benefits for new residents. Complex but manageable.",
    "description": "Barcelona blends beaches, mountains, Gaudí architecture, world-class culture, excellent food, and cosmopolitan lifestyle in one vibrant city.",
    "lifestyle_description": "Dynamic cosmopolitan lifestyle. Beach and city combined. Rich cultural life. International atmosphere. Excellent dining. Work-life balance culture.",
    "cultural_attractions": ["Sagrada Familia", "Park Güell", "Gothic Quarter", "Museums (Picasso, MNAC)", "Modernist architecture", "Cultural events"],
    "outdoor_activities": ["City beaches", "Montjuïc mountain", "Collserola parks", "Coastal walks", "Sailing", "Day trips to Costa Brava"],
    "senior_communities": ["Large international community", "Expat groups by nationality", "Cultural centers", "Sports clubs", "Language exchanges", "Senior programs"],
    "volunteer_opportunities": ["Social programs", "Cultural organizations", "Environmental projects", "Food banks", "Teaching", "Festival support"],
    "nearby_airports": ["Barcelona El Prat (BCN)", "Girona (1 hour)", "Reus (1 hour)"],
    "public_transport_quality": "Excellent. Extensive metro, bus, tram network. Senior discounts. Very accessible.",
    "walkability_score": 88,
    "bike_infrastructure": "Very good. 200km bike lanes. Bicing bike-share. Flat near coast.",
    "internet_speed_mbps": 300,
    "utilities_monthly_eur": 130,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 600,
    "sunshine_hours_year": 2500,
    "expat_population": "Very Large (200,000+)",
    "restaurant_variety": "World-class - from tapas to Michelin stars",
    "golf_courses_nearby": 10,
    "special_considerations": "Tourist crowds. Catalan language present. Some political tensions. Expensive housing. Pickpocket risk.",
    "best_time_to_visit": "April-June, September-October",
    "image_url": "https://example.com/barcelona.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable with some regional tensions",
    "lgbtq_friendliness": "Very accepting, gay capital of southern Europe",
    "disability_access": "Good, especially newer areas",
    "pet_friendliness": "Pet-friendly with some beach restrictions",
    "retirement_visa_available": true
}'::jsonb);

-- 14. PORTO, PORTUGAL
SELECT update_town_data('Porto, Portugal', '{
    "country": "Portugal",
    "region": "Northern Portugal",
    "latitude": 41.1579,
    "longitude": -8.6291,
    "population": 240000,
    "weather_summer_high": 25,
    "weather_summer_low": 15,
    "weather_winter_high": 14,
    "weather_winter_low": 5,
    "cost_of_living_index": 55,
    "rent_1br_city_center_eur": 800,
    "rent_1br_outside_center_eur": 600,
    "meal_inexpensive_restaurant_eur": 8.00,
    "groceries_index": 48,
    "public_transport_monthly_eur": 40,
    "language": "Portuguese",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 81,
    "healthcare_description": "Excellent healthcare with major hospitals. EU citizens covered. Many private options. Growing number of English-speaking doctors.",
    "safety_index": 80,
    "crime_description": "Safe city with low crime. Tourist areas need normal precautions. Residential areas very safe. Good street lighting.",
    "visa_requirements": "Same as rest of Portugal. EU citizens free. Non-EU need D7 or Golden Visa. 90-day tourist visa-free.",
    "residency_info": "Portuguese residency process. NHR tax benefits available. Growing expat services. Clear path to permanent residence.",
    "tax_info": "NHR regime available. 10% on foreign pensions. No wealth tax. Reasonable property taxes. Very attractive for retirees.",
    "description": "Porto offers authentic Portuguese charm, port wine culture, stunning architecture, cooler climate, and lower costs than Lisbon.",
    "lifestyle_description": "Authentic Portuguese lifestyle. Less touristy than Lisbon. Strong food and wine culture. Cooler, rainier weather. Growing cultural scene.",
    "cultural_attractions": ["Historic center UNESCO site", "Port wine cellars", "Serralves Museum", "São Bento Station", "Livraria Lello", "Churches and azulejos"],
    "outdoor_activities": ["River walks", "Nearby beaches", "Douro Valley trips", "City parks", "Coastal cycling", "Golf courses"],
    "senior_communities": ["Growing expat community", "International Porto group", "Wine appreciation clubs", "Walking groups", "Cultural associations"],
    "volunteer_opportunities": ["Social projects", "Food banks", "Animal welfare", "Environmental groups", "Teaching English", "Cultural events"],
    "nearby_airports": ["Porto Airport (OPO)", "Vigo, Spain (1.5 hours)", "Lisbon (3 hours by train)"],
    "public_transport_quality": "Good metro, buses, trams. Historic trams. Expanding metro. Senior discounts.",
    "walkability_score": 75,
    "bike_infrastructure": "Developing. Some bike lanes. Hilly terrain challenging.",
    "internet_speed_mbps": 120,
    "utilities_monthly_eur": 90,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Oceanic Mediterranean",
    "annual_rainfall_mm": 1200,
    "sunshine_hours_year": 2000,
    "expat_population": "Growing (30,000+)",
    "restaurant_variety": "Excellent Portuguese cuisine, growing international options",
    "golf_courses_nearby": 12,
    "special_considerations": "Rainier than southern Portugal. Hills can be challenging. Portuguese helpful for full integration.",
    "best_time_to_visit": "May-September",
    "image_url": "https://example.com/porto.jpg",
    "timezone": "Western European Time (WET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable EU democracy",
    "lgbtq_friendliness": "Accepting and improving",
    "disability_access": "Challenging in historic areas",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": true
}'::jsonb);

-- 15. SPLIT, CROATIA
SELECT update_town_data('Split, Croatia', '{
    "country": "Croatia",
    "region": "Dalmatian Coast",
    "latitude": 43.5081,
    "longitude": 16.4402,
    "population": 180000,
    "weather_summer_high": 30,
    "weather_summer_low": 21,
    "weather_winter_high": 11,
    "weather_winter_low": 5,
    "cost_of_living_index": 50,
    "rent_1br_city_center_eur": 600,
    "rent_1br_outside_center_eur": 450,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 55,
    "public_transport_monthly_eur": 35,
    "language": "Croatian",
    "english_proficiency": "High",
    "healthcare_quality_index": 72,
    "healthcare_description": "Good public healthcare, improving rapidly. EU citizens covered with EHIC. Private clinics available. Medical tourism growing.",
    "safety_index": 85,
    "crime_description": "Very safe city. Low crime rates. Tourist areas well-policed. Local neighborhoods extremely safe. Friendly locals.",
    "visa_requirements": "EU citizens can stay 90/180 days. Long-term requires temporary residence. US citizens 90 days visa-free. Digital nomad visa available.",
    "residency_info": "Temporary residence renewable annually. Permanent residence after 5 years. Must show income/accommodation. Process improving.",
    "tax_info": "Flat tax option 12% for foreign income. Progressive rates 20-30% otherwise. No wealth tax. Property tax minimal.",
    "description": "Split combines Roman history, crystal-clear Adriatic waters, island hopping, Mediterranean lifestyle, and increasing expat-friendliness.",
    "lifestyle_description": "Relaxed Dalmatian lifestyle. Beach culture. Café society. Growing expat community. Excellent seafood. Island exploration. Less developed than Western Europe.",
    "cultural_attractions": ["Diocletian''s Palace", "Old Town UNESCO site", "Museums and galleries", "Summer festivals", "Local markets", "Roman ruins"],
    "outdoor_activities": ["Beaches and swimming", "Island hopping", "Sailing and boating", "Marjan hill hiking", "Sea kayaking", "Cycling"],
    "senior_communities": ["Growing expat groups", "International meetups", "Sailing clubs", "Walking groups", "Language exchanges"],
    "volunteer_opportunities": ["Environmental projects", "Animal shelters", "Community programs", "Tourism support", "Teaching English", "Cultural events"],
    "nearby_airports": ["Split Airport (SPU)", "Zadar (1.5 hours)", "Dubrovnik (3 hours)"],
    "public_transport_quality": "Basic city buses. Ferries to islands. Improving infrastructure. Car useful for exploring.",
    "walkability_score": 78,
    "bike_infrastructure": "Limited but developing. Coastal paths good for cycling.",
    "internet_speed_mbps": 80,
    "utilities_monthly_eur": 100,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 800,
    "sunshine_hours_year": 2700,
    "expat_population": "Growing (10,000+)",
    "restaurant_variety": "Good local cuisine, increasing international options",
    "golf_courses_nearby": 2,
    "special_considerations": "Tourist crowds in summer. Some services close in winter. Croatian language helpful. EU membership bringing improvements.",
    "best_time_to_visit": "May-June, September-October",
    "image_url": "https://example.com/split.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR) from 2023",
    "political_stability": "Stable EU member",
    "lgbtq_friendliness": "Improving, more accepted in tourist areas",
    "disability_access": "Challenging in old town",
    "pet_friendliness": "Pet-friendly culture",
    "retirement_visa_available": false
}'::jsonb);

-- 16. DUBROVNIK, CROATIA
SELECT update_town_data('Dubrovnik, Croatia', '{
    "country": "Croatia",
    "region": "Southern Dalmatia",
    "latitude": 42.6507,
    "longitude": 18.0944,
    "population": 42000,
    "weather_summer_high": 29,
    "weather_summer_low": 21,
    "weather_winter_high": 12,
    "weather_winter_low": 6,
    "cost_of_living_index": 55,
    "rent_1br_city_center_eur": 700,
    "rent_1br_outside_center_eur": 500,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 58,
    "public_transport_monthly_eur": 30,
    "language": "Croatian",
    "english_proficiency": "High",
    "healthcare_quality_index": 73,
    "healthcare_description": "Good healthcare with main hospital. EU citizens covered. Tourist medical services available. Some specialists in Split/Zagreb.",
    "safety_index": 88,
    "crime_description": "Extremely safe city. Very low crime. Well-preserved old town secure. Tourist areas monitored. Local areas very peaceful.",
    "visa_requirements": "Same as Split. EU citizens 90/180 days. US citizens 90 days visa-free. Temporary residence for longer stays.",
    "residency_info": "Croatian residence permit required for long stays. Income requirements. Growing expat services. EU membership helps.",
    "tax_info": "Same Croatian tax system. Flat tax option available. Tourist rental income taxed. Overall favorable rates.",
    "description": "Dubrovnik, the ''Pearl of the Adriatic,'' offers stunning medieval walls, crystal waters, Game of Thrones fame, and refined coastal living.",
    "lifestyle_description": "Tourist-influenced but authentic local life exists. Stunning setting. Quiet winters. Cultural events. Higher prices than rest of Croatia. UNESCO heritage.",
    "cultural_attractions": ["City walls walk", "Old Town UNESCO site", "Rector''s Palace", "Summer Festival", "Cable car views", "Lokrum Island"],
    "outdoor_activities": ["Sea kayaking", "Beach activities", "Island trips", "Coastal walks", "Swimming", "Boat excursions"],
    "senior_communities": ["Small expat community", "International visitors", "Cultural groups", "Walking clubs", "Social meetups"],
    "volunteer_opportunities": ["Heritage preservation", "Environmental projects", "Tourism support", "Community programs", "Cultural events"],
    "nearby_airports": ["Dubrovnik Airport (DBV)", "Split (3 hours)", "Montenegro nearby"],
    "public_transport_quality": "Local buses adequate. No trains. Boats to islands. Walking in old town. Car useful outside city.",
    "walkability_score": 75,
    "bike_infrastructure": "Limited due to terrain. Some coastal paths.",
    "internet_speed_mbps": 75,
    "utilities_monthly_eur": 110,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 1000,
    "sunshine_hours_year": 2600,
    "expat_population": "Small (2,000+)",
    "restaurant_variety": "Good Croatian cuisine, tourist-oriented options",
    "golf_courses_nearby": 1,
    "special_considerations": "Very touristy in summer. Cruise ship crowds. More expensive than other Croatian cities. Quiet winters.",
    "best_time_to_visit": "May-June, September-October",
    "image_url": "https://example.com/dubrovnik.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable EU member",
    "lgbtq_friendliness": "Accepting in tourist areas",
    "disability_access": "Very challenging in old town",
    "pet_friendliness": "Pet-friendly outside old town",
    "retirement_visa_available": false
}'::jsonb);

-- 17. ATHENS, GREECE
SELECT update_town_data('Athens, Greece', '{
    "country": "Greece",
    "region": "Attica",
    "latitude": 37.9838,
    "longitude": 23.7275,
    "population": 3200000,
    "weather_summer_high": 34,
    "weather_summer_low": 23,
    "weather_winter_high": 14,
    "weather_winter_low": 6,
    "cost_of_living_index": 58,
    "rent_1br_city_center_eur": 500,
    "rent_1br_outside_center_eur": 400,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 50,
    "public_transport_monthly_eur": 30,
    "language": "Greek",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 74,
    "healthcare_description": "Public healthcare (ESY) available but variable quality. Private healthcare excellent and affordable. EU citizens covered with EHIC.",
    "safety_index": 70,
    "crime_description": "Generally safe but some areas to avoid. Petty crime in tourist zones. Most residential areas safe. Protests occasionally disrupt city center.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need residence permit (€2,000/month income). Golden Visa popular. 90-day visa-free tourism.",
    "residency_info": "Residence permits renewable. Golden Visa for €250,000 property investment. New digital nomad visa. Tax benefits available.",
    "tax_info": "Progressive tax 9-44%. New 7% flat tax for foreign pensioners. Property taxes variable. Overall competitive rates.",
    "description": "Athens blends ancient history with modern urban life, offering year-round sunshine, vibrant culture, and access to islands and beaches.",
    "lifestyle_description": "Vibrant city life with ancient backdrop. Late dining culture. Café society. Easy island access. Mix of chaos and charm. Growing expat community.",
    "cultural_attractions": ["Acropolis and Parthenon", "National Archaeological Museum", "Plaka neighborhood", "Ancient Agora", "Modern art scene", "Stavros Niarchos Center"],
    "outdoor_activities": ["Nearby beaches", "Mount Lycabettus hikes", "Island day trips", "Riviera coastal areas", "Parks and gardens", "Archaeological walks"],
    "senior_communities": ["International community", "Athens Expats group", "Cultural associations", "Sports clubs", "Volunteer organizations"],
    "volunteer_opportunities": ["Refugee support", "Archaeological projects", "Environmental groups", "Animal welfare", "Community programs", "Cultural initiatives"],
    "nearby_airports": ["Athens International (ATH)", "Island connections", "Domestic network"],
    "public_transport_quality": "Good metro, buses, trams. Expanding metro. Can be crowded. Strikes occasional issue.",
    "walkability_score": 72,
    "bike_infrastructure": "Limited but improving. Some dedicated paths.",
    "internet_speed_mbps": 60,
    "utilities_monthly_eur": 120,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 400,
    "sunshine_hours_year": 2800,
    "expat_population": "Large (100,000+)",
    "restaurant_variety": "Excellent Greek cuisine plus international options",
    "golf_courses_nearby": 5,
    "special_considerations": "Summer heat intense. Some areas run-down. Traffic congestion. Air quality issues. Greek helpful but not essential.",
    "best_time_to_visit": "April-June, September-November",
    "image_url": "https://example.com/athens.jpg",
    "timezone": "Eastern European Time (EET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable democracy, past economic issues",
    "lgbtq_friendliness": "Generally accepting, especially in city",
    "disability_access": "Challenging, improving slowly",
    "pet_friendliness": "Very pet-friendly culture",
    "retirement_visa_available": true
}'::jsonb);

-- 18. ROME, ITALY
SELECT update_town_data('Rome, Italy', '{
    "country": "Italy",
    "region": "Lazio",
    "latitude": 41.9028,
    "longitude": 12.4964,
    "population": 2800000,
    "weather_summer_high": 32,
    "weather_summer_low": 20,
    "weather_winter_high": 13,
    "weather_winter_low": 4,
    "cost_of_living_index": 72,
    "rent_1br_city_center_eur": 1100,
    "rent_1br_outside_center_eur": 700,
    "meal_inexpensive_restaurant_eur": 15.00,
    "groceries_index": 62,
    "public_transport_monthly_eur": 35,
    "language": "Italian",
    "english_proficiency": "Moderate",
    "healthcare_quality_index": 82,
    "healthcare_description": "Excellent healthcare with major hospitals. Public system (SSN) free for residents. Many private options. Some English-speaking doctors.",
    "safety_index": 71,
    "crime_description": "Generally safe but watch for pickpockets near tourist sites. Most neighborhoods safe. Good police presence. Avoid empty areas at night.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need elective residency visa (€31,000/year). Various visa types available. 90-day tourist visa.",
    "residency_info": "Permesso di soggiorno required. Renewable permits. Permanent residence after 5 years. Bureaucracy can be challenging.",
    "tax_info": "Progressive tax 23-43%. New 7% flat tax for retirees in southern regions. Rome excluded from flat tax. Property taxes moderate.",
    "description": "Rome, the Eternal City, offers unparalleled history, art, cuisine, and culture, with modern amenities in an ancient setting.",
    "lifestyle_description": "Vibrant urban lifestyle with historical backdrop. Excellent food culture. Busy and chaotic but charming. Strong neighborhood communities. La dolce vita philosophy.",
    "cultural_attractions": ["Colosseum and Forum", "Vatican City", "Countless museums", "Baroque churches", "Trastevere district", "Villa Borghese"],
    "outdoor_activities": ["Parks and gardens", "Tiber River walks", "Day trips to countryside", "Beach towns nearby", "Appian Way cycling", "Seven Hills exploration"],
    "senior_communities": ["International community", "American/British groups", "Cultural associations", "University programs", "Religious communities"],
    "volunteer_opportunities": ["Archaeological projects", "Church organizations", "Refugee support", "Cultural heritage", "Teaching programs", "Food banks"],
    "nearby_airports": ["Rome Fiumicino (FCO)", "Rome Ciampino (CIA)", "High-speed rail connections"],
    "public_transport_quality": "Adequate but aging. Metro limited. Buses comprehensive but unreliable. Taxis available. Walking often best.",
    "walkability_score": 78,
    "bike_infrastructure": "Limited. Traffic challenging. Some parks good for cycling.",
    "internet_speed_mbps": 100,
    "utilities_monthly_eur": 140,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean",
    "annual_rainfall_mm": 800,
    "sunshine_hours_year": 2500,
    "expat_population": "Very Large (150,000+)",
    "restaurant_variety": "World-class Italian cuisine, good international options",
    "golf_courses_nearby": 20,
    "special_considerations": "Tourist crowds. Traffic congestion. Bureaucracy challenging. Italian helpful for daily life. August very hot and empty.",
    "best_time_to_visit": "April-June, September-October",
    "image_url": "https://example.com/rome.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable democracy with frequent government changes",
    "lgbtq_friendliness": "Generally accepting, Vatican influence present",
    "disability_access": "Challenging in historic areas",
    "pet_friendliness": "Very pet-friendly city",
    "retirement_visa_available": true
}'::jsonb);

-- 19. MILAN, ITALY
SELECT update_town_data('Milan, Italy', '{
    "country": "Italy",
    "region": "Lombardy",
    "latitude": 45.4642,
    "longitude": 9.1900,
    "population": 1400000,
    "weather_summer_high": 30,
    "weather_summer_low": 19,
    "weather_winter_high": 8,
    "weather_winter_low": 1,
    "cost_of_living_index": 80,
    "rent_1br_city_center_eur": 1300,
    "rent_1br_outside_center_eur": 800,
    "meal_inexpensive_restaurant_eur": 15.00,
    "groceries_index": 65,
    "public_transport_monthly_eur": 39,
    "language": "Italian",
    "english_proficiency": "Moderate to High",
    "healthcare_quality_index": 85,
    "healthcare_description": "Some of Italy''s best hospitals. Excellent public and private care. Many specialists. International clinics. More English-speaking doctors than other Italian cities.",
    "safety_index": 73,
    "crime_description": "Generally safe. Some petty crime near stations. Business districts very safe. Good lighting and police presence. Avoid parks at night.",
    "visa_requirements": "Same as rest of Italy. EU citizens free. Non-EU need appropriate visa. Business and investment visas common. 90-day tourist visa.",
    "residency_info": "Italian residence permit system. Milan efficient for bureaucracy. Many expat services. Clear processes compared to other Italian cities.",
    "tax_info": "Progressive Italian taxes apply. No special retiree benefits in Milan. Higher cost of living but better services. Business-friendly environment.",
    "description": "Milan is Italy''s economic capital, offering sophisticated urban living, fashion, culture, excellent transport links, and modern efficiency.",
    "lifestyle_description": "Fast-paced business atmosphere. International outlook. Fashion and design capital. Excellent restaurants. Cultural events. Less touristy than Rome. Modern European city.",
    "cultural_attractions": ["La Scala Opera House", "Duomo Cathedral", "Last Supper painting", "Fashion District", "Modern art museums", "Design exhibitions"],
    "outdoor_activities": ["Navigli canal district", "Sempione Park", "Day trips to lakes", "Alps 1 hour away", "Cycling paths", "Golf clubs"],
    "senior_communities": ["Large international community", "Business clubs", "Cultural associations", "Sports clubs", "Expat groups by nationality"],
    "volunteer_opportunities": ["Social services", "Cultural organizations", "Environmental projects", "Business mentoring", "Language teaching", "Expo legacy projects"],
    "nearby_airports": ["Milan Malpensa (MXP)", "Milan Linate (LIN)", "Bergamo (BGY)"],
    "public_transport_quality": "Excellent. Extensive metro, trams, buses. Best in Italy. Senior discounts. Very reliable.",
    "walkability_score": 82,
    "bike_infrastructure": "Good and expanding. Bike-sharing system. Dedicated lanes increasing.",
    "internet_speed_mbps": 200,
    "utilities_monthly_eur": 150,
    "beaches_nearby": false,
    "mountains_nearby": true,
    "climate_zone": "Humid subtropical",
    "annual_rainfall_mm": 1000,
    "sunshine_hours_year": 1900,
    "expat_population": "Very Large (200,000+)",
    "restaurant_variety": "Excellent - Italian and extensive international options",
    "golf_courses_nearby": 25,
    "special_considerations": "Expensive city. Fog and pollution in winter. August empty. More formal than southern Italy. Italian useful but English more common.",
    "best_time_to_visit": "April-June, September-October",
    "image_url": "https://example.com/milan.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable, economic powerhouse of Italy",
    "lgbtq_friendliness": "Very accepting, progressive city",
    "disability_access": "Good, best in Italy",
    "pet_friendliness": "Pet-friendly with some restrictions",
    "retirement_visa_available": true
}'::jsonb);

-- 20. LJUBLJANA, SLOVENIA
SELECT update_town_data('Ljubljana, Slovenia', '{
    "country": "Slovenia",
    "region": "Central Slovenia",
    "latitude": 46.0569,
    "longitude": 14.5058,
    "population": 295000,
    "weather_summer_high": 27,
    "weather_summer_low": 15,
    "weather_winter_high": 5,
    "weather_winter_low": -2,
    "cost_of_living_index": 60,
    "rent_1br_city_center_eur": 700,
    "rent_1br_outside_center_eur": 500,
    "meal_inexpensive_restaurant_eur": 10.00,
    "groceries_index": 55,
    "public_transport_monthly_eur": 37,
    "language": "Slovenian",
    "english_proficiency": "High",
    "healthcare_quality_index": 78,
    "healthcare_description": "Good public healthcare system. EU citizens covered. Private options available. Many doctors speak English. Modern facilities.",
    "safety_index": 89,
    "crime_description": "One of Europe''s safest capitals. Very low crime rates. Safe to walk anywhere. Strong community feel. Excellent street lighting.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need residence permit. Income requirements moderate. 90-day visa-free for many countries.",
    "residency_info": "EU residence rules apply. Permanent residence after 5 years. Relatively straightforward process. English widely used in offices.",
    "tax_info": "Progressive tax 16-50%. No wealth tax. Property tax low. Overall moderate tax burden. Some benefits for foreign residents.",
    "description": "Ljubljana is a charming, green capital offering safety, walkability, cultural richness, and easy access to mountains and sea.",
    "lifestyle_description": "Relaxed pace with café culture. Very green and pedestrian-friendly. Strong cultural life. Four seasons. Outdoor-oriented population. Hidden gem of Europe.",
    "cultural_attractions": ["Ljubljana Castle", "Dragon Bridge", "Tivoli Park", "Museums and galleries", "Metelkova alternative culture", "River cafés"],
    "outdoor_activities": ["City park walks", "River kayaking", "Cycling paths", "Alps 30 minutes away", "Adriatic 1 hour away", "Hiking trails"],
    "senior_communities": ["Small expat community", "International club", "Cultural societies", "Sports groups", "Language exchanges"],
    "volunteer_opportunities": ["Environmental projects", "Cultural events", "Social programs", "Youth mentoring", "Community gardens", "Festival support"],
    "nearby_airports": ["Ljubljana Airport (LJU)", "Zagreb (2 hours)", "Venice (3 hours)"],
    "public_transport_quality": "Good city buses. No metro/tram. Very walkable center. Bike-friendly. Car useful for exploring.",
    "walkability_score": 85,
    "bike_infrastructure": "Excellent. Extensive bike lanes. Bike-sharing system. Flat terrain.",
    "internet_speed_mbps": 100,
    "utilities_monthly_eur": 150,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Continental",
    "annual_rainfall_mm": 1400,
    "sunshine_hours_year": 1700,
    "expat_population": "Small (10,000+)",
    "restaurant_variety": "Good Slovenian cuisine, growing international scene",
    "golf_courses_nearby": 5,
    "special_considerations": "Small city feel. Cold winters. Language barrier for some services. Limited direct flights. Hidden costs can add up.",
    "best_time_to_visit": "May-September",
    "image_url": "https://example.com/ljubljana.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable EU democracy",
    "lgbtq_friendliness": "Progressive and accepting",
    "disability_access": "Good in center, improving",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": false
}'::jsonb);

-- 21. ABRUZZO, ITALY
SELECT update_town_data('Abruzzo, Italy', '{
    "country": "Italy",
    "region": "Central Italy",
    "latitude": 42.3505,
    "longitude": 13.3995,
    "population": 1300000,
    "weather_summer_high": 30,
    "weather_summer_low": 18,
    "weather_winter_high": 10,
    "weather_winter_low": 2,
    "cost_of_living_index": 48,
    "rent_1br_city_center_eur": 400,
    "rent_1br_outside_center_eur": 300,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 45,
    "public_transport_monthly_eur": 30,
    "language": "Italian",
    "english_proficiency": "Low",
    "healthcare_quality_index": 75,
    "healthcare_description": "Good regional hospitals. Italian public healthcare (SSN). EU citizens covered. Private options in larger towns. Italian language important.",
    "safety_index": 88,
    "crime_description": "Very safe region. Low crime rates. Strong family values. Rural areas extremely peaceful. Some towns almost crime-free.",
    "visa_requirements": "Same as rest of Italy. 7% flat tax incentive for foreign retirees in small towns. EU citizens unrestricted. Non-EU need visa.",
    "residency_info": "Italian residence permits apply. Special tax benefits for retirees. Must live in town under 20,000 people for tax break.",
    "tax_info": "7% flat tax on all foreign income for retirees in small towns! Valid for 10 years. Huge savings. Best tax deal in Europe.",
    "description": "Abruzzo offers authentic Italy with mountains meeting sea, medieval villages, incredible food, low costs, and special retiree tax benefits.",
    "lifestyle_description": "Authentic Italian rural life. Slow pace. Strong traditions. Amazing local food. Pristine nature. Very few tourists. Real Italy experience.",
    "cultural_attractions": ["Medieval hill towns", "Castles and abbeys", "Traditional festivals", "Local crafts", "Wine routes", "Archaeological sites"],
    "outdoor_activities": ["Gran Sasso mountains", "Adriatic beaches", "National parks", "Hiking trails", "Skiing in winter", "Cycling routes"],
    "senior_communities": ["Small but growing expat presence", "Italian social clubs", "Church communities", "Local integration important", "Language exchanges developing"],
    "volunteer_opportunities": ["Earthquake reconstruction", "Environmental projects", "Community festivals", "Agricultural programs", "Teaching", "Cultural preservation"],
    "nearby_airports": ["Pescara Airport (PSR)", "Rome (2 hours)", "Naples (2.5 hours)"],
    "public_transport_quality": "Limited. Buses connect main towns. Trains along coast. Car essential for mountain areas.",
    "walkability_score": 65,
    "bike_infrastructure": "Limited but scenic rural roads. Mountain biking popular.",
    "internet_speed_mbps": 50,
    "utilities_monthly_eur": 80,
    "beaches_nearby": true,
    "mountains_nearby": true,
    "climate_zone": "Mediterranean/Mountain",
    "annual_rainfall_mm": 700,
    "sunshine_hours_year": 2300,
    "expat_population": "Small but growing (5,000+)",
    "restaurant_variety": "Excellent local cuisine, very limited international",
    "golf_courses_nearby": 3,
    "special_considerations": "Italian essential. Very traditional. Limited services. Earthquakes possible. Perfect for those seeking authentic, quiet life.",
    "best_time_to_visit": "May-October",
    "image_url": "https://example.com/abruzzo.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable as part of Italy",
    "lgbtq_friendliness": "Traditional, improving slowly",
    "disability_access": "Challenging in hill towns",
    "pet_friendliness": "Very pet-friendly rural culture",
    "retirement_visa_available": true
}'::jsonb);

-- 22. TURIN, ITALY
SELECT update_town_data('Turin, Italy', '{
    "country": "Italy",
    "region": "Piedmont",
    "latitude": 45.0703,
    "longitude": 7.6869,
    "population": 875000,
    "weather_summer_high": 28,
    "weather_summer_low": 17,
    "weather_winter_high": 7,
    "weather_winter_low": -1,
    "cost_of_living_index": 65,
    "rent_1br_city_center_eur": 700,
    "rent_1br_outside_center_eur": 500,
    "meal_inexpensive_restaurant_eur": 12.00,
    "groceries_index": 58,
    "public_transport_monthly_eur": 38,
    "language": "Italian",
    "english_proficiency": "Low to Moderate",
    "healthcare_quality_index": 82,
    "healthcare_description": "Excellent healthcare with major hospitals. Italian SSN provides comprehensive coverage. Some English-speaking doctors. Medical research centers.",
    "safety_index": 76,
    "crime_description": "Generally safe city. Some petty crime in center. Residential areas very safe. Good street lighting. Active community policing.",
    "visa_requirements": "Standard Italian visa requirements. EU citizens unrestricted. Non-EU need appropriate visa. No special regional benefits.",
    "residency_info": "Italian permesso di soggiorno system. Efficient compared to southern Italy. Good expat support services developing.",
    "tax_info": "Standard Italian progressive tax. No special retiree benefits in Turin. Higher taxes than special zones but better services.",
    "description": "Turin offers elegant architecture, Alps proximity, rich culture, chocolate, wine, and authentic Italian life without tourist crowds.",
    "lifestyle_description": "Sophisticated yet understated. Strong café culture. Excellent food and wine. Cultural events. Less touristy than major Italian cities. Four distinct seasons.",
    "cultural_attractions": ["Egyptian Museum", "Royal Palace", "Mole Antonelliana", "Baroque architecture", "Cinema Museum", "Contemporary art"],
    "outdoor_activities": ["Alps 1 hour away", "Po River parks", "Hill walks", "Skiing nearby", "Wine country tours", "Cycling paths"],
    "senior_communities": ["Growing expat community", "Cultural associations", "Sports clubs", "Wine appreciation groups", "Language exchanges"],
    "volunteer_opportunities": ["Cultural heritage", "Social services", "Environmental projects", "Olympics legacy programs", "Teaching", "Museum support"],
    "nearby_airports": ["Turin Airport (TRN)", "Milan Malpensa (2 hours)", "Geneva (3 hours)"],
    "public_transport_quality": "Good metro, trams, buses. Reliable and clean. Senior discounts. Well-connected.",
    "walkability_score": 78,
    "bike_infrastructure": "Good and improving. Bike-sharing available. Many dedicated lanes.",
    "internet_speed_mbps": 150,
    "utilities_monthly_eur": 130,
    "beaches_nearby": false,
    "mountains_nearby": true,
    "climate_zone": "Humid subtropical",
    "annual_rainfall_mm": 900,
    "sunshine_hours_year": 2000,
    "expat_population": "Moderate (40,000+)",
    "restaurant_variety": "Excellent Piedmontese cuisine, some international options",
    "golf_courses_nearby": 15,
    "special_considerations": "Industrial past visible. Cold winters. Italian language very helpful. Less international than Milan. Fog common.",
    "best_time_to_visit": "May-June, September-October",
    "image_url": "https://example.com/turin.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Stable as major Italian city",
    "lgbtq_friendliness": "Progressive and accepting",
    "disability_access": "Good in newer areas",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": true
}'::jsonb);

-- 23. BORDEAUX, FRANCE
SELECT update_town_data('Bordeaux, France', '{
    "country": "France",
    "region": "Nouvelle-Aquitaine",
    "latitude": 44.8378,
    "longitude": -0.5792,
    "population": 260000,
    "weather_summer_high": 27,
    "weather_summer_low": 15,
    "weather_winter_high": 11,
    "weather_winter_low": 3,
    "cost_of_living_index": 72,
    "rent_1br_city_center_eur": 850,
    "rent_1br_outside_center_eur": 650,
    "meal_inexpensive_restaurant_eur": 13.00,
    "groceries_index": 68,
    "public_transport_monthly_eur": 50,
    "language": "French",
    "english_proficiency": "Low to Moderate",
    "healthcare_quality_index": 86,
    "healthcare_description": "Excellent French healthcare. Top-rated hospitals. Universal coverage for residents. Many specialists. Some English-speaking doctors in private clinics.",
    "safety_index": 75,
    "crime_description": "Generally safe. Some areas to avoid at night. Historic center very safe. Good police presence. Residential areas peaceful.",
    "visa_requirements": "EU citizens unrestricted. Non-EU need long-stay visa. Income requirements around €1,500/month. Various visa categories available.",
    "residency_info": "French carte de séjour system. Renewable permits. Permanent residence after 5 years. Integration requirements including basic French.",
    "tax_info": "French progressive tax system. No special benefits for retirees. Wealth tax on high assets. Property taxes moderate. Complex but fair.",
    "description": "Bordeaux offers world-class wine culture, UNESCO architecture, Atlantic proximity, sophisticated lifestyle, and French art de vivre.",
    "lifestyle_description": "Refined lifestyle with wine at center. Excellent restaurants. Cultural events. Less pretentious than Paris. Growing tech scene. Perfect French city size.",
    "cultural_attractions": ["UNESCO historic center", "Wine museums", "Grand Théâtre", "Contemporary art center", "Miroir d''eau", "Wine château tours"],
    "outdoor_activities": ["Atlantic beaches (1 hour)", "Cycling routes", "River walks", "Wine country tours", "Arcachon Bay", "Dune du Pilat"],
    "senior_communities": ["British expat community", "Wine appreciation clubs", "Cultural associations", "International groups", "Sports clubs"],
    "volunteer_opportunities": ["Wine heritage projects", "Cultural events", "Environmental groups", "Social services", "Language teaching", "Festival support"],
    "nearby_airports": ["Bordeaux Airport (BOD)", "Paris by TGV (2 hours)", "Toulouse (2 hours)"],
    "public_transport_quality": "Excellent trams, buses. Expanding network. Senior discounts. Very efficient.",
    "walkability_score": 80,
    "bike_infrastructure": "Excellent. Extensive bike lanes. V3 bike-sharing. Flat terrain.",
    "internet_speed_mbps": 180,
    "utilities_monthly_eur": 140,
    "beaches_nearby": true,
    "mountains_nearby": false,
    "climate_zone": "Oceanic",
    "annual_rainfall_mm": 950,
    "sunshine_hours_year": 2000,
    "expat_population": "Moderate (30,000+)",
    "restaurant_variety": "Excellent French cuisine, growing international options",
    "golf_courses_nearby": 12,
    "special_considerations": "French language important. Wine culture central. Can be touristy. Atlantic weather changeable. Formal social culture.",
    "best_time_to_visit": "May-October",
    "image_url": "https://example.com/bordeaux.jpg",
    "timezone": "Central European Time (CET)",
    "currency": "Euro (EUR)",
    "political_stability": "Very stable French democracy",
    "lgbtq_friendliness": "Generally accepting",
    "disability_access": "Good, historic areas challenging",
    "pet_friendliness": "Very pet-friendly",
    "retirement_visa_available": true
}'::jsonb);

-- Clean up temporary function
DROP FUNCTION IF EXISTS update_town_data(TEXT, JSONB);

-- Commit the transaction
COMMIT;

-- =====================================================
-- VERIFICATION QUERIES
-- Run these to confirm all data is populated
-- =====================================================

-- Check for any NULL values in critical columns
SELECT 
    name,
    COUNT(*) FILTER (WHERE country IS NULL) as country_nulls,
    COUNT(*) FILTER (WHERE region IS NULL) as region_nulls,
    COUNT(*) FILTER (WHERE population IS NULL) as population_nulls,
    COUNT(*) FILTER (WHERE cost_of_living_index IS NULL) as col_nulls,
    COUNT(*) FILTER (WHERE healthcare_quality_index IS NULL) as healthcare_nulls,
    COUNT(*) FILTER (WHERE safety_index IS NULL) as safety_nulls
FROM towns
WHERE name IN (
    'Algarve, Portugal', 'Andalusia, Spain', 'Puglia, Italy', 'Malta', 'Crete, Greece',
    'Cyprus', 'Madeira, Portugal', 'Canary Islands, Spain', 'Azores, Portugal', 'Nice, France',
    'Lisbon, Portugal', 'Valencia, Spain', 'Barcelona, Spain', 'Porto, Portugal', 'Split, Croatia',
    'Dubrovnik, Croatia', 'Athens, Greece', 'Rome, Italy', 'Milan, Italy', 'Ljubljana, Slovenia',
    'Abruzzo, Italy', 'Turin, Italy', 'Bordeaux, France'
)
GROUP BY name
ORDER BY name;

-- Count total populated fields per town
SELECT 
    name,
    (CASE WHEN country IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN region IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN latitude IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN longitude IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN population IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_summer_high IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_summer_low IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_winter_high IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_winter_low IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN cost_of_living_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN rent_1br_city_center_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN rent_1br_outside_center_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN meal_inexpensive_restaurant_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN groceries_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN public_transport_monthly_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN language IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN english_proficiency IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN healthcare_quality_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN healthcare_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN safety_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN crime_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN visa_requirements IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN residency_info IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN tax_info IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN lifestyle_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN cultural_attractions IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN outdoor_activities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN senior_communities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN volunteer_opportunities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN nearby_airports IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN public_transport_quality IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN walkability_score IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN bike_infrastructure IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN internet_speed_mbps IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN utilities_monthly_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN beaches_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN mountains_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN climate_zone IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN annual_rainfall_mm IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN sunshine_hours_year IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN expat_population IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN restaurant_variety IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN golf_courses_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN special_considerations IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN best_time_to_visit IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN image_url IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN timezone IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN currency IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN political_stability IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN lgbtq_friendliness IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN disability_access IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN pet_friendliness IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN retirement_visa_available IS NOT NULL THEN 1 ELSE 0 END) as populated_fields,
    55 as total_fields,
    ROUND(((CASE WHEN country IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN region IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN latitude IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN longitude IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN population IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_summer_high IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_summer_low IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_winter_high IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN weather_winter_low IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN cost_of_living_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN rent_1br_city_center_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN rent_1br_outside_center_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN meal_inexpensive_restaurant_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN groceries_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN public_transport_monthly_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN language IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN english_proficiency IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN healthcare_quality_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN healthcare_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN safety_index IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN crime_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN visa_requirements IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN residency_info IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN tax_info IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN lifestyle_description IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN cultural_attractions IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN outdoor_activities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN senior_communities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN volunteer_opportunities IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN nearby_airports IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN public_transport_quality IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN walkability_score IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN bike_infrastructure IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN internet_speed_mbps IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN utilities_monthly_eur IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN beaches_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN mountains_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN climate_zone IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN annual_rainfall_mm IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN sunshine_hours_year IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN expat_population IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN restaurant_variety IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN golf_courses_nearby IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN special_considerations IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN best_time_to_visit IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN image_url IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN timezone IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN currency IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN political_stability IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN lgbtq_friendliness IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN disability_access IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN pet_friendliness IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN retirement_visa_available IS NOT NULL THEN 1 ELSE 0 END)::numeric / 55 * 100), 2) as completion_percentage
FROM towns
WHERE name IN (
    'Algarve, Portugal', 'Andalusia, Spain', 'Puglia, Italy', 'Malta', 'Crete, Greece',
    'Cyprus', 'Madeira, Portugal', 'Canary Islands, Spain', 'Azores, Portugal', 'Nice, France',
    'Lisbon, Portugal', 'Valencia, Spain', 'Barcelona, Spain', 'Porto, Portugal', 'Split, Croatia',
    'Dubrovnik, Croatia', 'Athens, Greece', 'Rome, Italy', 'Milan, Italy', 'Ljubljana, Slovenia',
    'Abruzzo, Italy', 'Turin, Italy', 'Bordeaux, France'
)
ORDER BY completion_percentage DESC, name;

-- Final summary
SELECT 
    COUNT(*) as total_towns,
    COUNT(*) FILTER (WHERE 
        country IS NOT NULL AND
        region IS NOT NULL AND
        population IS NOT NULL AND
        cost_of_living_index IS NOT NULL AND
        healthcare_quality_index IS NOT NULL AND
        safety_index IS NOT NULL
    ) as towns_with_core_data,
    COUNT(*) FILTER (WHERE 
        retirement_visa_available IS NOT NULL AND
        pet_friendliness IS NOT NULL AND
        disability_access IS NOT NULL AND
        lgbtq_friendliness IS NOT NULL
    ) as towns_with_all_new_fields
FROM towns
WHERE name IN (
    'Algarve, Portugal', 'Andalusia, Spain', 'Puglia, Italy', 'Malta', 'Crete, Greece',
    'Cyprus', 'Madeira, Portugal', 'Canary Islands, Spain', 'Azores, Portugal', 'Nice, France',
    'Lisbon, Portugal', 'Valencia, Spain', 'Barcelona, Spain', 'Porto, Portugal', 'Split, Croatia',
    'Dubrovnik, Croatia', 'Athens, Greece', 'Rome, Italy', 'Milan, Italy', 'Ljubljana, Slovenia',
    'Abruzzo, Italy', 'Turin, Italy', 'Bordeaux, France'
);

-- =====================================================
-- SUCCESS! 
-- This script populates all 23 towns with complete data
-- Run the verification queries to confirm zero NULL values
-- =====================================================