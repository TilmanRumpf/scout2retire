# Scout2Retire Navigation - Quick Reference Guide

## Navigation Structure at a Glance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UNIFIED HEADER (ALL PAGES)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [Logo] [Title] ... [Notifications] [Menu]   â”‚â”‚ Row 1 (Always)
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ [Steps/Tabs/Filters/Comparison/Custom]      â”‚â”‚ Row 2 (Priority)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â””â”€â†’ Menu Button Opens â†’
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  QUICKNAV (RIGHT-SLIDE OVERLAY)  â”‚
        â”‚  w-64 (256px), z-1000            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Scout2Retire | âš™ï¸ (admin)         â”‚ Fixed
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ â˜€ï¸ Today                          â”‚
        â”‚ ğŸ” Discover        â† SEARCH HERE â”‚
        â”‚ â¤ï¸ Favorites                     â”‚
        â”‚ âš–ï¸ Compare                        â”‚
        â”‚ ğŸ“… Schedule                      â”‚
        â”‚ ğŸ’¬ Chat                      [5] â”‚ Badge
        â”‚ âœ¨ Scotty AI                     â”‚
        â”‚ ğŸ“” Journal                       â”‚
        â”‚ ğŸ‘¤ Profile                       â”‚
        â”‚ âš™ï¸ Preferences                   â”‚
        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
        â”‚ S2R Admin (Admin only)           â”‚
        â”‚   Towns-Manager                  â”‚
        â”‚   User Manager & Paywall         â”‚
        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
        â”‚ ğŸšª Logout                        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Â© 2025 Scout2Retire              â”‚ Fixed
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## URL Routing Map

```
â”Œâ”€ PUBLIC ROUTES (redirect to /daily if authenticated)
â”‚  â”œâ”€ /welcome
â”‚  â”œâ”€ /login
â”‚  â”œâ”€ /signup
â”‚  â””â”€ /reset-password
â”‚
â”œâ”€ ONBOARDING ROUTES (10 steps)
â”‚  â”œâ”€ /onboarding/progress
â”‚  â”œâ”€ /onboarding/current-status
â”‚  â”œâ”€ /onboarding/region
â”‚  â”œâ”€ /onboarding/climate
â”‚  â”œâ”€ /onboarding/culture
â”‚  â”œâ”€ /onboarding/hobbies
â”‚  â”œâ”€ /onboarding/administration
â”‚  â”œâ”€ /onboarding/costs
â”‚  â”œâ”€ /onboarding/review
â”‚  â””â”€ /onboarding/complete
â”‚
â”œâ”€ MAIN ROUTES (Protected, require login)
â”‚  â”œâ”€ /daily                    â† Default landing
â”‚  â”œâ”€ /discover?town=<id>       â† SEARCH DESTINATION
â”‚  â”œâ”€ /favorites
â”‚  â”œâ”€ /compare
â”‚  â”œâ”€ /chat
â”‚  â”œâ”€ /chat/:townId
â”‚  â”œâ”€ /chat/group/:groupId
â”‚  â”œâ”€ /scotty
â”‚  â”œâ”€ /journal
â”‚  â”œâ”€ /profile?tab=<name>
â”‚  â”œâ”€ /schedule
â”‚  â””â”€ /settings (â†’ /profile?tab=account)
â”‚
â””â”€ ADMIN ROUTES (Protected + admin_role check)
   â”œâ”€ /admin/towns-manager?town=<id>
   â””â”€ /admin/paywall
```

---

## Data Flow: Search to Results

```
STEP 1: USER INITIATES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Clicks search icon/input in:           â”‚
â”‚ â€¢ QuickNav menu                        â”‚
â”‚ â€¢ UnifiedHeader (if added)             â”‚
â”‚ â€¢ FilterBarV3 on Discover page         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 2: CAPTURE INPUT
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search term state updated              â”‚
â”‚ Show real-time suggestions (optional)  â”‚
â”‚ Example: "florida" â†’ [town list]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 3: NAVIGATE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User presses Enter OR clicks result    â”‚
â”‚ navigate('/discover?search=florida')   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 4: PAGE LOADS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TownDiscovery component mounts         â”‚
â”‚ Extract URL params: ?search=florida    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 5: FETCH DATA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fetchTowns({                           â”‚
â”‚   userId,                              â”‚
â”‚   usePersonalization: true,            â”‚
â”‚   country/region/cost/match filters    â”‚
â”‚ })                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 6: DATABASE QUERY
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase query:                        â”‚
â”‚ SELECT id, name, country, ...          â”‚
â”‚ FROM towns                             â”‚
â”‚ WHERE (name ILIKE '%florida%'          â”‚
â”‚   OR description ILIKE '%florida%')    â”‚
â”‚ AND image_url_1 IS NOT NULL            â”‚
â”‚ ORDER BY match_percentage DESC         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 7: APPLY SCORING
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ If personalized:                       â”‚
â”‚ â€¢ Calculate match % (0-100)            â”‚
â”‚ â€¢ Apply user preferences               â”‚
â”‚ â€¢ Sort by match descending             â”‚
â”‚ Else: Show all matching towns          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 8: RENDER RESULTS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TownDiscovery displays:                â”‚
â”‚ â€¢ Grid of TownCard components          â”‚
â”‚ â€¢ Match badges (top-left)              â”‚
â”‚ â€¢ Favorite hearts                      â”‚
â”‚ â€¢ Cost and safety info                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
STEP 9: USER ACTIONS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Click town â†’ See details             â”‚
â”‚ â€¢ Click heart â†’ Add to favorites       â”‚
â”‚ â€¢ Adjust filters â†’ Re-filter results   â”‚
â”‚ â€¢ New search â†’ Back to step 1          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

```
App (React Router)
  â””â”€ UnifiedHeader (ALL PAGES)
      â”œâ”€ Row 1: Logo, Title, Notifications, Menu
      â””â”€ Row 2: Steps OR Tabs OR Filters OR Custom
  
  â””â”€ QuickNav (Hamburger Menu)
      â”œâ”€ Header (Logo)
      â”œâ”€ Nav Items
      â”‚  â””â”€ Links to all pages
      â”œâ”€ Admin Section (if is_admin)
      â””â”€ Footer (Copyright)
  
  â””â”€ Pages
      â””â”€ TownDiscovery
          â”œâ”€ UnifiedHeader (with FilterBarV3)
          â”œâ”€ FilterBarV3
          â”‚  â”œâ”€ Search input
          â”‚  â”œâ”€ Sort dropdown
          â”‚  â”œâ”€ Region/Country filters
          â”‚  â”œâ”€ Cost/Match filters
          â”‚  â””â”€ Portal dropdowns
          â””â”€ Town Grid
              â””â”€ TownCard (x343)
                  â”œâ”€ Image
                  â”œâ”€ Match badge
                  â”œâ”€ Title/Country
                  â”œâ”€ Cost info
                  â””â”€ Favorite button
```

---

## File Organization

```
src/
â”œâ”€ components/
â”‚  â”œâ”€ QuickNav.jsx                 â† Navigation menu
â”‚  â”œâ”€ UnifiedHeader.jsx            â† Header (all pages)
â”‚  â”œâ”€ FilterBarV3.jsx              â† Filter UI
â”‚  â”œâ”€ TownCard.jsx                 â† Town display card
â”‚  â””â”€ [other components]
â”‚
â”œâ”€ pages/
â”‚  â”œâ”€ App.jsx                      â† Router config
â”‚  â”œâ”€ TownDiscovery.jsx            â† Search destination
â”‚  â”œâ”€ Daily.jsx
â”‚  â”œâ”€ Favorites.jsx
â”‚  â””â”€ [other pages]
â”‚
â”œâ”€ utils/
â”‚  â”œâ”€ townUtils.jsx                â† fetchTowns()
â”‚  â”œâ”€ userSearchUtils.js           â† findUserByEmail()
â”‚  â”œâ”€ supabaseClient.js            â† Supabase config
â”‚  â””â”€ [other utils]
â”‚
â”œâ”€ styles/
â”‚  â”œâ”€ uiConfig.ts                  â† Design tokens
â”‚  â”œâ”€ DESIGN_STANDARDS.md          â† UI guidelines
â”‚  â””â”€ [stylesheets]
â”‚
â”œâ”€ contexts/
â”‚  â”œâ”€ AuthContext.jsx
â”‚  â””â”€ ThemeContext.jsx
â”‚
â””â”€ App.jsx                          â† Entry point
```

---

## Key State Management Patterns

### Page-Level State (TownDiscovery)
```javascript
const [towns, setTowns] = useState([]);
const [searchTerm, setSearchTerm] = useState('');
const [sortBy, setSortBy] = useState('match');
const [filterRegion, setFilterRegion] = useState('all');
const [filterCountry, setFilterCountry] = useState('all');
const [filterCostRange, setFilterCostRange] = useState('all');
const [favorites, setFavorites] = useState([]);
```

### Global Context State
```javascript
// AuthContext
const { user, profile, loading } = useAuth();

// ThemeContext
const { isDark, setIsDark } = useTheme();
```

### URL-Based State
```javascript
const location = useLocation();
const navigate = useNavigate();

// Extract from URL
const params = new URLSearchParams(location.search);
const townId = params.get('town');
const searchQuery = params.get('search');
```

### Real-Time State (Supabase)
```javascript
useEffect(() => {
  const subscription = supabase
    .channel('town-updates')
    .on('postgres_changes', { event: '*', table: 'towns' }, 
      (payload) => {
        // Update state on change
      }
    )
    .subscribe();
  
  return () => subscription.unsubscribe();
}, []);
```

---

## Design System Quick Lookup

| Element | Light Mode | Dark Mode |
|---------|-----------|----------|
| **Card** | bg-white | bg-gray-900 |
| **Text** | text-gray-800 | text-white |
| **Accent** | scout-accent-600 | scout-accent-300 |
| **Border** | border-gray-200 | border-gray-700 |
| **Button** | scout-accent-500 | scout-accent-400 |
| **Hover** | hover:bg-gray-50 | hover:bg-gray-700 |

---

## Common Code Patterns

### Navigating with Parameters
```javascript
navigate(`/discover?search=${searchTerm}`);
navigate(`/admin/towns-manager?town=${townId}`);
```

### Fetching Towns
```javascript
const result = await fetchTowns({
  userId: user.id,
  usePersonalization: true,
  country: 'Spain',
  maxCost: 1500
});
```

### Toggle Favorite
```javascript
const { success, action } = await toggleFavorite(userId, townId);
// action: 'added' or 'removed'
```

### Real-Time Badge Update
```javascript
const totalUnread = counts.reduce(
  (sum, item) => sum + (item.unread_count || 0), 
  0
);
setPendingInvitesCount(prevCount => prevCount + 1);
```

---

## Mobile vs Desktop Differences

| Feature | Mobile | Desktop |
|---------|--------|---------|
| **Menu** | Slide-out (w-64) | Always visible (nav bar) |
| **Header** | Compact, hidden logo | Full with logo |
| **Filters** | Modal overlay | Inline bar |
| **Grid** | 1 column | 2-3 columns |
| **Font** | text-xs | text-sm |
| **Touch** | 44px min | 32px typical |
| **Spacing** | p-3 | p-4 |

---

## Performance Tips

1. **Always use COLUMN_SETS** (not SELECT *)
2. **Lazy load pages** (React.lazy)
3. **Debounce search input** (300ms)
4. **Cleanup subscriptions** (useEffect return)
5. **Memoize expensive components** (React.memo)
6. **Use requestAnimationFrame** for smooth scrolling
7. **Leverage React suspense** for loading states

---

## Testing Checklist

- [ ] Menu opens/closes correctly
- [ ] All navigation links work
- [ ] Search filters results
- [ ] Favorites toggle works
- [ ] Mobile responsive (375px, 768px)
- [ ] Dark mode colors correct
- [ ] Touch targets 44px minimum
- [ ] Real-time badges update
- [ ] Admin items only show for admins
- [ ] URL parameters preserved on reload

---

**Quick Reference Version**: 1.0  
**Date**: 2025-10-19  
**Status**: Ready
